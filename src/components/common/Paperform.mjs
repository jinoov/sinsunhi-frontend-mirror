// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Env from "../../constants/Env.mjs";
import * as React from "react";
import * as ReactUtil from "../../utils/ReactUtil.mjs";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";
import * as Caml_option from "rescript/lib/es6/caml_option.js";
import * as Webapi__Dom__Element from "rescript-webapi/src/Webapi/Dom/Webapi__Dom__Element.mjs";
import * as Webapi__Dom__Document from "rescript-webapi/src/Webapi/Dom/Webapi__Dom__Document.mjs";

function modifyPaperformZIndex(param) {
  var element = document.querySelector(".Paperform__popupwrapper");
  if (!(element == null)) {
    element.setAttribute("style", "z-index: 20;");
    return ;
  }
  
}

function removeBodyScrollLock(param) {
  var body = document.querySelector("body");
  if (body == null) {
    return ;
  }
  var bodyClassList = body.classList;
  bodyClassList.remove("blockScroll");
  bodyClassList.remove("ab-pause-scrolling");
}

function makeScriptTag(param) {
  return Webapi__Dom__Element.asHtmlElement(document.createElement("script"));
}

function getPaperformBtn(paperFormId) {
  return Belt_Option.flatMap(Caml_option.nullable_to_opt(document.getElementById(paperFormId)), Webapi__Dom__Element.asHtmlElement);
}

function Paperform(props) {
  var paperFormId = props.paperFormId;
  var attrs = {
    id: paperFormId,
    "data-paperform-id": paperFormId,
    className: "hidden",
    prefill: props.prefill,
    "data-popup-button": "1",
    spinner: "1"
  };
  React.useEffect((function () {
          var script = Webapi__Dom__Element.asHtmlElement(document.createElement("script"));
          var paperformBtn = getPaperformBtn(paperFormId);
          var body = Belt_Option.flatMap(Webapi__Dom__Document.asHtmlDocument(document), (function (prim) {
                  return Caml_option.nullable_to_opt(prim.body);
                }));
          if (body !== undefined && script !== undefined && paperformBtn !== undefined) {
            var paperformBtn$p = Caml_option.valFromOption(paperformBtn);
            var script$p = Caml_option.valFromOption(script);
            script$p.setAttribute("src", Env.paperformEmbedUrl);
            script$p.addEventListener("load", (function (param) {
                    paperformBtn$p.click();
                    setTimeout((function (param) {
                            modifyPaperformZIndex(undefined);
                            removeBodyScrollLock(undefined);
                          }), 500);
                  }));
            Caml_option.valFromOption(body).appendChild(script$p);
          }
          
        }), []);
  return React.createElement(ReactUtil.SpreadProps.make, {
              children: React.createElement("button", undefined),
              props: attrs
            });
}

var make = Paperform;

export {
  modifyPaperformZIndex ,
  removeBodyScrollLock ,
  makeScriptTag ,
  getPaperformBtn ,
  make ,
}
/* Env Not a pure module */
