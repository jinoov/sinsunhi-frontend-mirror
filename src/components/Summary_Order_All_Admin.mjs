// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Curry from "rescript/lib/es6/curry.js";
import * as Input from "./common/Input.mjs";
import * as React from "react";
import * as Js_dict from "rescript/lib/es6/js_dict.js";
import * as Js_json from "rescript/lib/es6/js_json.js";
import * as Belt_Array from "rescript/lib/es6/belt_Array.js";
import * as DatePicker from "./DatePicker.mjs";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";
import * as Caml_option from "rescript/lib/es6/caml_option.js";
import * as CustomHooks from "../utils/CustomHooks.mjs";
import * as ReactEvents from "../utils/ReactEvents.mjs";
import * as Router from "next/router";
import * as Garter_Array from "@greenlabs/garter/src/Garter_Array.mjs";
import * as PeriodSelector from "./common/PeriodSelector.mjs";
import Parse from "date-fns/parse";
import * as IconArrowSelect from "./svgs/IconArrowSelect.mjs";
import * as ReForm__Helpers from "@rescriptbr/reform/src/ReForm__Helpers.mjs";
import Format from "date-fns/format";
import SubDays from "date-fns/subDays";
import * as Query_Order_All_Form_Admin from "./Query_Order_All_Form_Admin.mjs";

function Summary_Order_All_Admin(Props) {
  var router = Router.useRouter();
  var match = React.useState(function () {
        
      });
  var setOrderType = match[1];
  var orderType = match[0];
  var match$1 = React.useState(function () {
        return {
                from: SubDays(new Date(), 7),
                to_: new Date()
              };
      });
  var setQuery = match$1[1];
  var query = match$1[0];
  var onSubmit = function (param) {
    var state = param.state;
    var productName = Query_Order_All_Form_Admin.FormFields.get(state.values, /* ProductName */0);
    var producerName = Query_Order_All_Form_Admin.FormFields.get(state.values, /* ProducerName */1);
    var buyerName = Query_Order_All_Form_Admin.FormFields.get(state.values, /* BuyerName */2);
    router.query["product-name"] = productName;
    router.query["producer-name"] = producerName;
    router.query["buyer-name"] = buyerName;
    router.query["order-type"] = Belt_Option.getWithDefault(Belt_Option.flatMap(orderType, (function (orderType$p) {
                return Js_json.decodeString(CustomHooks.OrdersAllAdmin.orderType_encode(orderType$p));
              })), "");
    router.query["from"] = Format(query.from, "yyyyMMdd");
    router.query["to"] = Format(query.to_, "yyyyMMdd");
    router.query["offset"] = "0";
    router.push(router.pathname + "?" + new URLSearchParams(router.query).toString());
    
  };
  var form = Curry._7(Query_Order_All_Form_Admin.Form.use, Query_Order_All_Form_Admin.initialState, /* Schema */{
        _0: Belt_Array.concatMany([
              Curry._4(Query_Order_All_Form_Admin.Form.ReSchema.Validation.regExp, "최소 2글자를 입력해주세요.", "^(?:.{2,}|)$", undefined, /* ProductName */0),
              Curry._4(Query_Order_All_Form_Admin.Form.ReSchema.Validation.regExp, "최소 2글자를 입력해주세요.", "^(?:.{2,}|)$", undefined, /* ProducerName */1),
              Curry._4(Query_Order_All_Form_Admin.Form.ReSchema.Validation.regExp, "최소 2글자를 입력해주세요.", "^(?:.{2,}|)$", undefined, /* BuyerName */2)
            ])
      }, onSubmit, undefined, undefined, /* OnChange */0, undefined);
  var handleOnSubmit = function (param) {
    return ReactEvents.interceptingHandler((function (param) {
                  return Curry._1(form.submit, undefined);
                }), param);
  };
  React.useEffect((function () {
          Curry._1(form.resetForm, undefined);
          Garter_Array.forEach(Js_dict.entries(router.query), (function (entry) {
                  var v = entry[1];
                  var k = entry[0];
                  if (k === "product-name") {
                    return Curry._4(form.setFieldValue, /* ProductName */0, v, true, undefined);
                  }
                  if (k === "producer-name") {
                    return Curry._4(form.setFieldValue, /* ProducerName */1, v, true, undefined);
                  }
                  if (k === "buyer-name") {
                    return Curry._4(form.setFieldValue, /* BuyerName */2, v, true, undefined);
                  }
                  if (k !== "order-type") {
                    if (k === "from") {
                      return setQuery(function (prev) {
                                  return {
                                          from: Parse(v, "yyyyMMdd", new Date()),
                                          to_: prev.to_
                                        };
                                });
                    } else if (k === "to") {
                      return setQuery(function (prev) {
                                  return {
                                          from: prev.from,
                                          to_: Parse(v, "yyyyMMdd", new Date())
                                        };
                                });
                    } else {
                      return ;
                    }
                  }
                  var v$p = CustomHooks.OrdersAllAdmin.orderType_decode(v);
                  if (v$p.TAG !== /* Ok */0) {
                    return setOrderType(function (param) {
                                
                              });
                  }
                  var v$p$1 = v$p._0;
                  return setOrderType(function (param) {
                              return v$p$1;
                            });
                }));
          
        }), [router.query]);
  var handleOnChangeDate = function (t, e) {
    var newDate = e.detail.valueAsDate;
    if (t) {
      if (newDate === undefined) {
        return ;
      }
      var newDate$p = Caml_option.valFromOption(newDate);
      return setQuery(function (prev) {
                  return {
                          from: prev.from,
                          to_: newDate$p
                        };
                });
    }
    if (newDate === undefined) {
      return ;
    }
    var newDate$p$1 = Caml_option.valFromOption(newDate);
    return setQuery(function (prev) {
                return {
                        from: newDate$p$1,
                        to_: prev.to_
                      };
              });
  };
  var handleOnChangePeriod = function (d) {
    return setQuery(function (prev) {
                return {
                        from: d,
                        to_: prev.to_
                      };
              });
  };
  var handleOnReset = function (param) {
    return ReactEvents.interceptingHandler((function (param) {
                  Curry._4(form.setFieldValue, /* ProductName */0, "", true, undefined);
                  Curry._4(form.setFieldValue, /* ProducerName */1, "", true, undefined);
                  Curry._4(form.setFieldValue, /* BuyerName */2, "", true, undefined);
                  return setQuery(function (param) {
                              return {
                                      from: SubDays(new Date(), 7),
                                      to_: new Date()
                                    };
                            });
                }), param);
  };
  var partial_arg = Curry._1(form.handleChange, /* ProductName */0);
  var partial_arg$1 = Curry._1(form.handleChange, /* ProducerName */1);
  var partial_arg$2 = Curry._1(form.handleChange, /* BuyerName */2);
  return React.createElement("div", {
              className: "p-7 mt-4 mx-4 shadow-gl bg-white rounded"
            }, React.createElement("form", {
                  onSubmit: handleOnSubmit
                }, React.createElement("div", {
                      className: "py-3 flex flex-col text-sm bg-gray-gl rounded-xl"
                    }, React.createElement("div", {
                          className: "flex"
                        }, React.createElement("div", {
                              className: "w-32 font-bold mt-2 pl-7 whitespace-nowrap"
                            }, "검색"), React.createElement("div", {
                              className: "flex-1"
                            }, React.createElement("div", {
                                  className: "flex"
                                }, React.createElement("div", {
                                      className: "flex-1 flex flex-col sm:flex-initial sm:w-64 sm:flex-row sm:items-center mr-16"
                                    }, React.createElement("label", {
                                          className: "whitespace-nowrap",
                                          style: {
                                            marginRight: "21px"
                                          },
                                          htmlFor: "product-name"
                                        }, "상품명"), React.createElement(Input.make, {
                                          type_: "text",
                                          name: "product-name",
                                          placeholder: "상품명 입력",
                                          value: Query_Order_All_Form_Admin.FormFields.get(form.values, /* ProductName */0),
                                          onChange: (function (param) {
                                              return ReForm__Helpers.handleChange(partial_arg, param);
                                            }),
                                          error: Curry._1(form.getFieldError, /* Field */{
                                                _0: /* ProductName */0
                                              }),
                                          tabIndex: 1
                                        })), React.createElement("div", {
                                      className: "flex-1 flex flex-col sm:flex-initial sm:w-64 sm:flex-row sm:items-center mr-16"
                                    }, React.createElement("label", {
                                          className: "whitespace-nowrap mr-2",
                                          htmlFor: "producer-name"
                                        }, "생산자명"), React.createElement(Input.make, {
                                          type_: "text",
                                          name: "producer-name",
                                          placeholder: "생산자명 입력",
                                          value: Query_Order_All_Form_Admin.FormFields.get(form.values, /* ProducerName */1),
                                          onChange: (function (param) {
                                              return ReForm__Helpers.handleChange(partial_arg$1, param);
                                            }),
                                          error: Curry._1(form.getFieldError, /* Field */{
                                                _0: /* ProducerName */1
                                              }),
                                          tabIndex: 2
                                        })), React.createElement("div", {
                                      className: "flex-1 flex flex-col sm:flex-initial sm:w-64 sm:flex-row sm:items-center"
                                    }, React.createElement("label", {
                                          className: "whitespace-nowrap mr-2",
                                          htmlFor: "buyer-name"
                                        }, "바이어명"), React.createElement(Input.make, {
                                          type_: "text",
                                          name: "buyer-name",
                                          placeholder: "바이어명 입력",
                                          value: Query_Order_All_Form_Admin.FormFields.get(form.values, /* BuyerName */2),
                                          onChange: (function (param) {
                                              return ReForm__Helpers.handleChange(partial_arg$2, param);
                                            }),
                                          error: Curry._1(form.getFieldError, /* Field */{
                                                _0: /* BuyerName */2
                                              }),
                                          tabIndex: 3
                                        }))), React.createElement("div", {
                                  className: "flex mt-3"
                                }, React.createElement("div", {
                                      className: "w-64 flex items-center mr-16"
                                    }, React.createElement("label", {
                                          className: "whitespace-nowrap mr-2",
                                          htmlFor: "sales-kind"
                                        }, "거래유형"), React.createElement("div", {
                                          className: "flex-1 block relative"
                                        }, React.createElement("span", {
                                              className: "flex items-center border border-border-default-L1 rounded-lg py-2 px-3 text-enabled-L1 bg-white leading-4.5"
                                            }, Belt_Option.getWithDefault(Belt_Option.flatMap(Belt_Option.map(orderType, CustomHooks.OrdersAllAdmin.orderType_encode), Js_json.decodeString), "전체")), React.createElement("span", {
                                              className: "absolute top-1.5 right-2"
                                            }, React.createElement(IconArrowSelect.make, {
                                                  height: "24",
                                                  width: "24",
                                                  fill: "#121212"
                                                })), React.createElement("select", {
                                              className: "block w-full h-full absolute top-0 opacity-0",
                                              id: "period",
                                              value: Belt_Option.getWithDefault(Belt_Option.flatMap(Belt_Option.map(orderType, CustomHooks.OrdersAllAdmin.orderType_encode), Js_json.decodeString), "전체"),
                                              onChange: (function (param) {
                                                  var value = param.target.value;
                                                  var value$p = CustomHooks.OrdersAllAdmin.orderType_decode(value);
                                                  if (value$p.TAG !== /* Ok */0) {
                                                    return setOrderType(function (param) {
                                                                
                                                              });
                                                  }
                                                  var value$p$1 = value$p._0;
                                                  return setOrderType(function (param) {
                                                              return value$p$1;
                                                            });
                                                })
                                            }, React.createElement("option", {
                                                  value: "전체"
                                                }, "전체"), React.createElement("option", {
                                                  value: "온라인"
                                                }, "온라인"), React.createElement("option", {
                                                  value: "오프라인"
                                                }, "오프라인"))))))), React.createElement("div", {
                          className: "flex mt-3"
                        }, React.createElement("div", {
                              className: "w-32 font-bold flex items-center pl-7"
                            }, "기간"), React.createElement("div", {
                              className: "flex"
                            }, React.createElement("div", {
                                  className: "flex mr-8"
                                }, React.createElement(PeriodSelector.make, {
                                      from: query.from,
                                      to_: query.to_,
                                      onSelect: handleOnChangePeriod
                                    })), React.createElement(DatePicker.make, {
                                  id: "from",
                                  onChange: (function (param) {
                                      return handleOnChangeDate(/* From */0, param);
                                    }),
                                  date: query.from,
                                  maxDate: Format(new Date(), "yyyy-MM-dd"),
                                  firstDayOfWeek: 0
                                }), React.createElement("span", {
                                  className: "flex items-center mr-1"
                                }, "~"), React.createElement(DatePicker.make, {
                                  id: "to",
                                  onChange: (function (param) {
                                      return handleOnChangeDate(/* To */1, param);
                                    }),
                                  date: query.to_,
                                  maxDate: Format(new Date(), "yyyy-MM-dd"),
                                  minDate: Format(query.from, "yyyy-MM-dd"),
                                  firstDayOfWeek: 0
                                })))), React.createElement("div", {
                      className: "flex justify-center mt-5"
                    }, React.createElement("input", {
                          className: "w-20 py-2 bg-gray-button-gl text-black-gl rounded-xl ml-2 hover:bg-gray-button-gl focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-gray-gl focus:ring-opacity-100",
                          tabIndex: 7,
                          type: "button",
                          value: "초기화",
                          onClick: handleOnReset
                        }), React.createElement("input", {
                          className: "w-20 py-2 bg-green-gl text-white font-bold rounded-xl ml-2 hover:bg-green-gl-dark focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-green-gl focus:ring-opacity-100",
                          tabIndex: 6,
                          type: "submit",
                          value: "검색"
                        }))));
}

var FormFields;

var Form;

var make = Summary_Order_All_Admin;

export {
  FormFields ,
  Form ,
  make ,
  
}
/* Input Not a pure module */
