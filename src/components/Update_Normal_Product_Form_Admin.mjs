// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Cx from "rescript-classnames/src/Cx.mjs";
import * as Curry from "rescript/lib/es6/curry.js";
import * as Spice from "@greenlabs/ppx-spice/src/rescript/Spice.mjs";
import * as React from "react";
import * as Dialog from "./common/Dialog.mjs";
import * as Locale from "../utils/Locale.mjs";
import * as Js_dict from "rescript/lib/es6/js_dict.js";
import * as Js_json from "rescript/lib/es6/js_json.js";
import * as Checkbox from "./common/Checkbox.mjs";
import * as IconError from "./svgs/IconError.mjs";
import * as Belt_Array from "rescript/lib/es6/belt_Array.js";
import * as Belt_Float from "rescript/lib/es6/belt_Float.js";
import * as DatePicker from "./DatePicker.mjs";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";
import * as Belt_Result from "rescript/lib/es6/belt_Result.js";
import * as Caml_option from "rescript/lib/es6/caml_option.js";
import * as ProductForm from "../utils/ProductForm.mjs";
import * as ReactEvents from "../utils/ReactEvents.mjs";
import * as Router from "next/router";
import * as ReactRelay from "react-relay";
import * as Garter_Array from "@greenlabs/garter/src/Garter_Array.mjs";
import * as ReactHookForm from "../bindings/ReactHookForm/ReactHookForm.mjs";
import * as RelayRuntime from "relay-runtime";
import * as Select_Delivery from "./Select_Delivery.mjs";
import Format from "date-fns/format";
import * as ReactHookForm$1 from "react-hook-form";
import * as Js_null_undefined from "rescript/lib/es6/js_null_undefined.js";
import * as Select_Tax_Status from "./Select_Tax_Status.mjs";
import EndOfDay from "date-fns/endOfDay";
import Async from "react-select/async";
import StartOfDay from "date-fns/startOfDay";
import * as Product_Detail_Editor from "./Product_Detail_Editor.mjs";
import * as RescriptRelay_Internal from "rescript-relay/src/RescriptRelay_Internal.mjs";
import * as Upload_Thumbnail_Admin from "./Upload_Thumbnail_Admin.mjs";
import * as ErrorMessage from "@hookform/error-message";
import * as Select_Product_Category from "./Select_Product_Category.mjs";
import * as Select_Display_Categories from "./Select_Display_Categories.mjs";
import * as Select_Product_Categories from "./Select_Product_Categories.mjs";
import * as ReactToastNotifications from "react-toast-notifications";
import * as Product_Detail_Basic_Admin from "./Product_Detail_Basic_Admin.mjs";
import * as Select_Product_Operation_Status from "./Select_Product_Operation_Status.mjs";
import * as Product_Detail_Display_Categories from "./Product_Detail_Display_Categories.mjs";
import * as Select_Product_NotationType_Admin from "./Select_Product_NotationType_Admin.mjs";
import * as Select_Product_QuotationType_Admin from "./Select_Product_QuotationType_Admin.mjs";
import * as UpdateNormalProductFormAdminFragment_graphql from "../__generated__/UpdateNormalProductFormAdminFragment_graphql.mjs";
import * as UpdateNormalProductFormAdminMutation_graphql from "../__generated__/UpdateNormalProductFormAdminMutation_graphql.mjs";

function use(fRef) {
  var data = ReactRelay.useFragment(UpdateNormalProductFormAdminFragment_graphql.node, fRef);
  return RescriptRelay_Internal.internal_useConvertedValue(UpdateNormalProductFormAdminFragment_graphql.Internal.convertFragment, data);
}

function useOpt(opt_fRef) {
  var fr = opt_fRef !== undefined ? Caml_option.some(Caml_option.valFromOption(opt_fRef)) : undefined;
  var nullableFragmentData = ReactRelay.useFragment(UpdateNormalProductFormAdminFragment_graphql.node, fr !== undefined ? Js_null_undefined.fromOption(Caml_option.some(Caml_option.valFromOption(fr))) : null);
  var data = (nullableFragmentData == null) ? undefined : Caml_option.some(nullableFragmentData);
  return RescriptRelay_Internal.internal_useConvertedValue((function (rawFragment) {
                if (rawFragment !== undefined) {
                  return UpdateNormalProductFormAdminFragment_graphql.Internal.convertFragment(rawFragment);
                }
                
              }), data);
}

var Fragment_displayCategoryType_decode = UpdateNormalProductFormAdminFragment_graphql.Utils.displayCategoryType_decode;

var Fragment_displayCategoryType_fromString = UpdateNormalProductFormAdminFragment_graphql.Utils.displayCategoryType_fromString;

var Fragment_productNotationInformationType_decode = UpdateNormalProductFormAdminFragment_graphql.Utils.productNotationInformationType_decode;

var Fragment_productNotationInformationType_fromString = UpdateNormalProductFormAdminFragment_graphql.Utils.productNotationInformationType_fromString;

var Fragment_productSalesType_decode = UpdateNormalProductFormAdminFragment_graphql.Utils.productSalesType_decode;

var Fragment_productSalesType_fromString = UpdateNormalProductFormAdminFragment_graphql.Utils.productSalesType_fromString;

var Fragment_productStatus_decode = UpdateNormalProductFormAdminFragment_graphql.Utils.productStatus_decode;

var Fragment_productStatus_fromString = UpdateNormalProductFormAdminFragment_graphql.Utils.productStatus_fromString;

var Fragment = {
  displayCategoryType_decode: Fragment_displayCategoryType_decode,
  displayCategoryType_fromString: Fragment_displayCategoryType_fromString,
  productNotationInformationType_decode: Fragment_productNotationInformationType_decode,
  productNotationInformationType_fromString: Fragment_productNotationInformationType_fromString,
  productSalesType_decode: Fragment_productSalesType_decode,
  productSalesType_fromString: Fragment_productSalesType_fromString,
  productStatus_decode: Fragment_productStatus_decode,
  productStatus_fromString: Fragment_productStatus_fromString,
  Types: undefined,
  Operation: undefined,
  use: use,
  useOpt: useOpt
};

function commitMutation(environment, variables, optimisticUpdater, optimisticResponse, updater, onCompleted, onError, uploadables, param) {
  return RelayRuntime.commitMutation(environment, {
              mutation: UpdateNormalProductFormAdminMutation_graphql.node,
              variables: UpdateNormalProductFormAdminMutation_graphql.Internal.convertVariables(variables),
              onCompleted: (function (res, err) {
                  if (onCompleted !== undefined) {
                    return Curry._2(onCompleted, UpdateNormalProductFormAdminMutation_graphql.Internal.convertResponse(res), (err == null) ? undefined : Caml_option.some(err));
                  }
                  
                }),
              onError: (function (err) {
                  if (onError !== undefined) {
                    return Curry._1(onError, (err == null) ? undefined : Caml_option.some(err));
                  }
                  
                }),
              optimisticResponse: optimisticResponse !== undefined ? UpdateNormalProductFormAdminMutation_graphql.Internal.convertWrapRawResponse(optimisticResponse) : undefined,
              optimisticUpdater: optimisticUpdater,
              updater: updater !== undefined ? (function (store, r) {
                    Curry._2(updater, store, UpdateNormalProductFormAdminMutation_graphql.Internal.convertResponse(r));
                  }) : undefined,
              uploadables: uploadables
            });
}

function use$1(param) {
  var match = ReactRelay.useMutation(UpdateNormalProductFormAdminMutation_graphql.node);
  var mutate = match[0];
  return [
          React.useMemo((function () {
                  return function (param, param$1, param$2, param$3, param$4, param$5, param$6, param$7, param$8) {
                    return Curry._1(mutate, {
                                onError: param,
                                onCompleted: param$1 !== undefined ? (function (r, errors) {
                                      Curry._2(param$1, UpdateNormalProductFormAdminMutation_graphql.Internal.convertResponse(r), (errors == null) ? undefined : Caml_option.some(errors));
                                    }) : undefined,
                                onUnsubscribe: param$2,
                                optimisticResponse: param$3 !== undefined ? UpdateNormalProductFormAdminMutation_graphql.Internal.convertWrapRawResponse(param$3) : undefined,
                                optimisticUpdater: param$4,
                                updater: param$5 !== undefined ? (function (store, r) {
                                      Curry._2(param$5, store, UpdateNormalProductFormAdminMutation_graphql.Internal.convertResponse(r));
                                    }) : undefined,
                                variables: UpdateNormalProductFormAdminMutation_graphql.Internal.convertVariables(param$6),
                                uploadables: param$7
                              });
                  };
                }), [mutate]),
          match[1]
        ];
}

var Mutation_errorCode_decode = UpdateNormalProductFormAdminMutation_graphql.Utils.errorCode_decode;

var Mutation_errorCode_fromString = UpdateNormalProductFormAdminMutation_graphql.Utils.errorCode_fromString;

var Mutation_normalProductType_decode = UpdateNormalProductFormAdminMutation_graphql.Utils.normalProductType_decode;

var Mutation_normalProductType_fromString = UpdateNormalProductFormAdminMutation_graphql.Utils.normalProductType_fromString;

var Mutation_productNotationInformationType_decode = UpdateNormalProductFormAdminMutation_graphql.Utils.productNotationInformationType_decode;

var Mutation_productNotationInformationType_fromString = UpdateNormalProductFormAdminMutation_graphql.Utils.productNotationInformationType_fromString;

var Mutation_productSalesType_decode = UpdateNormalProductFormAdminMutation_graphql.Utils.productSalesType_decode;

var Mutation_productSalesType_fromString = UpdateNormalProductFormAdminMutation_graphql.Utils.productSalesType_fromString;

var Mutation_productStatus_decode = UpdateNormalProductFormAdminMutation_graphql.Utils.productStatus_decode;

var Mutation_productStatus_fromString = UpdateNormalProductFormAdminMutation_graphql.Utils.productStatus_fromString;

var Mutation = {
  errorCode_decode: Mutation_errorCode_decode,
  errorCode_fromString: Mutation_errorCode_fromString,
  normalProductType_decode: Mutation_normalProductType_decode,
  normalProductType_fromString: Mutation_normalProductType_fromString,
  productNotationInformationType_decode: Mutation_productNotationInformationType_decode,
  productNotationInformationType_fromString: Mutation_productNotationInformationType_fromString,
  productSalesType_decode: Mutation_productSalesType_decode,
  productSalesType_fromString: Mutation_productSalesType_fromString,
  productStatus_decode: Mutation_productStatus_decode,
  productStatus_fromString: Mutation_productStatus_fromString,
  Operation: undefined,
  Types: undefined,
  commitMutation: commitMutation,
  use: use$1
};

function getTextInputStyle(disabled) {
  var defaultStyle = "px-3 py-2 border border-border-default-L1 rounded-lg h-9 focus:outline-none min-w-1/2 max-w-2xl";
  if (disabled) {
    return Cx.cx([
                defaultStyle,
                "bg-disabled-L3"
              ]);
  } else {
    return defaultStyle;
  }
}

function submit_encode(v) {
  return Js_dict.fromArray([
              [
                "producer-product-name",
                Spice.stringToJson(v.producerProductName)
              ],
              [
                "buyer-product-name",
                Spice.stringToJson(v.buyerProductName)
              ],
              [
                "base-price",
                Spice.intToJson(v.basePrice)
              ],
              [
                "origin",
                Spice.stringToJson(v.origin)
              ],
              [
                "product-category",
                Select_Product_Category.Form.submit_encode(v.productCategory)
              ],
              [
                "display-categories",
                Spice.arrayToJson(Select_Display_Categories.Form.submit_encode, v.displayCategories)
              ],
              [
                "product-operation-status",
                Select_Product_Operation_Status.Base.status_encode(v.operationStatus)
              ],
              [
                "product-delivery",
                Spice.stringToJson(v.delivery)
              ],
              [
                "product-quotable",
                Spice.boolToJson(v.quotable)
              ],
              [
                "notice",
                Spice.optionToJson(Spice.stringToJson, v.notice)
              ],
              [
                "notice-date-from",
                Spice.optionToJson(Spice.stringToJson, v.noticeStartAt)
              ],
              [
                "notice-date-to",
                Spice.optionToJson(Spice.stringToJson, v.noticeEndAt)
              ],
              [
                "thumbnail",
                Upload_Thumbnail_Admin.Form.image_encode(v.thumbnail)
              ],
              [
                "document-url",
                Spice.optionToJson(Spice.stringToJson, v.documentURL)
              ],
              [
                "description-html",
                Spice.stringToJson(v.editor)
              ],
              [
                "notation-information-type",
                Select_Product_NotationType_Admin.Notation.status_encode(v.notationInformationType)
              ],
              [
                "sales-type",
                Spice.optionToJson(Select_Product_QuotationType_Admin.QuotationType.t_encode, v.salesType)
              ]
            ]);
}

function submit_decode(v) {
  var dict = Js_json.classify(v);
  if (typeof dict === "number") {
    return Spice.error(undefined, "Not an object", v);
  }
  if (dict.TAG !== /* JSONObject */2) {
    return Spice.error(undefined, "Not an object", v);
  }
  var dict$1 = dict._0;
  var producerProductName = Spice.stringFromJson(Belt_Option.getWithDefault(Js_dict.get(dict$1, "producer-product-name"), null));
  if (producerProductName.TAG === /* Ok */0) {
    var buyerProductName = Spice.stringFromJson(Belt_Option.getWithDefault(Js_dict.get(dict$1, "buyer-product-name"), null));
    if (buyerProductName.TAG === /* Ok */0) {
      var basePrice = Spice.intFromJson(Belt_Option.getWithDefault(Js_dict.get(dict$1, "base-price"), null));
      if (basePrice.TAG === /* Ok */0) {
        var origin = Spice.stringFromJson(Belt_Option.getWithDefault(Js_dict.get(dict$1, "origin"), null));
        if (origin.TAG === /* Ok */0) {
          var productCategory = Select_Product_Category.Form.submit_decode(Belt_Option.getWithDefault(Js_dict.get(dict$1, "product-category"), null));
          if (productCategory.TAG === /* Ok */0) {
            var displayCategories = Spice.arrayFromJson(Select_Display_Categories.Form.submit_decode, Belt_Option.getWithDefault(Js_dict.get(dict$1, "display-categories"), null));
            if (displayCategories.TAG === /* Ok */0) {
              var operationStatus = Select_Product_Operation_Status.Base.status_decode(Belt_Option.getWithDefault(Js_dict.get(dict$1, "product-operation-status"), null));
              if (operationStatus.TAG === /* Ok */0) {
                var delivery = Spice.stringFromJson(Belt_Option.getWithDefault(Js_dict.get(dict$1, "product-delivery"), null));
                if (delivery.TAG === /* Ok */0) {
                  var quotable = Spice.boolFromJson(Belt_Option.getWithDefault(Js_dict.get(dict$1, "product-quotable"), null));
                  if (quotable.TAG === /* Ok */0) {
                    var notice = Spice.optionFromJson(Spice.stringFromJson, Belt_Option.getWithDefault(Js_dict.get(dict$1, "notice"), null));
                    if (notice.TAG === /* Ok */0) {
                      var noticeStartAt = Spice.optionFromJson(Spice.stringFromJson, Belt_Option.getWithDefault(Js_dict.get(dict$1, "notice-date-from"), null));
                      if (noticeStartAt.TAG === /* Ok */0) {
                        var noticeEndAt = Spice.optionFromJson(Spice.stringFromJson, Belt_Option.getWithDefault(Js_dict.get(dict$1, "notice-date-to"), null));
                        if (noticeEndAt.TAG === /* Ok */0) {
                          var thumbnail = Upload_Thumbnail_Admin.Form.image_decode(Belt_Option.getWithDefault(Js_dict.get(dict$1, "thumbnail"), null));
                          if (thumbnail.TAG === /* Ok */0) {
                            var documentURL = Spice.optionFromJson(Spice.stringFromJson, Belt_Option.getWithDefault(Js_dict.get(dict$1, "document-url"), null));
                            if (documentURL.TAG === /* Ok */0) {
                              var editor = Spice.stringFromJson(Belt_Option.getWithDefault(Js_dict.get(dict$1, "description-html"), null));
                              if (editor.TAG === /* Ok */0) {
                                var notationInformationType = Select_Product_NotationType_Admin.Notation.status_decode(Belt_Option.getWithDefault(Js_dict.get(dict$1, "notation-information-type"), null));
                                if (notationInformationType.TAG === /* Ok */0) {
                                  var salesType = Spice.optionFromJson(Select_Product_QuotationType_Admin.QuotationType.t_decode, Belt_Option.getWithDefault(Js_dict.get(dict$1, "sales-type"), null));
                                  if (salesType.TAG === /* Ok */0) {
                                    return {
                                            TAG: /* Ok */0,
                                            _0: {
                                              producerProductName: producerProductName._0,
                                              buyerProductName: buyerProductName._0,
                                              basePrice: basePrice._0,
                                              origin: origin._0,
                                              productCategory: productCategory._0,
                                              displayCategories: displayCategories._0,
                                              operationStatus: operationStatus._0,
                                              delivery: delivery._0,
                                              quotable: quotable._0,
                                              notice: notice._0,
                                              noticeStartAt: noticeStartAt._0,
                                              noticeEndAt: noticeEndAt._0,
                                              thumbnail: thumbnail._0,
                                              documentURL: documentURL._0,
                                              editor: editor._0,
                                              notationInformationType: notationInformationType._0,
                                              salesType: salesType._0
                                            }
                                          };
                                  }
                                  var e = salesType._0;
                                  return {
                                          TAG: /* Error */1,
                                          _0: {
                                            path: "." + ("sales-type" + e.path),
                                            message: e.message,
                                            value: e.value
                                          }
                                        };
                                }
                                var e$1 = notationInformationType._0;
                                return {
                                        TAG: /* Error */1,
                                        _0: {
                                          path: "." + ("notation-information-type" + e$1.path),
                                          message: e$1.message,
                                          value: e$1.value
                                        }
                                      };
                              }
                              var e$2 = editor._0;
                              return {
                                      TAG: /* Error */1,
                                      _0: {
                                        path: "." + ("description-html" + e$2.path),
                                        message: e$2.message,
                                        value: e$2.value
                                      }
                                    };
                            }
                            var e$3 = documentURL._0;
                            return {
                                    TAG: /* Error */1,
                                    _0: {
                                      path: "." + ("document-url" + e$3.path),
                                      message: e$3.message,
                                      value: e$3.value
                                    }
                                  };
                          }
                          var e$4 = thumbnail._0;
                          return {
                                  TAG: /* Error */1,
                                  _0: {
                                    path: "." + ("thumbnail" + e$4.path),
                                    message: e$4.message,
                                    value: e$4.value
                                  }
                                };
                        }
                        var e$5 = noticeEndAt._0;
                        return {
                                TAG: /* Error */1,
                                _0: {
                                  path: "." + ("notice-date-to" + e$5.path),
                                  message: e$5.message,
                                  value: e$5.value
                                }
                              };
                      }
                      var e$6 = noticeStartAt._0;
                      return {
                              TAG: /* Error */1,
                              _0: {
                                path: "." + ("notice-date-from" + e$6.path),
                                message: e$6.message,
                                value: e$6.value
                              }
                            };
                    }
                    var e$7 = notice._0;
                    return {
                            TAG: /* Error */1,
                            _0: {
                              path: "." + ("notice" + e$7.path),
                              message: e$7.message,
                              value: e$7.value
                            }
                          };
                  }
                  var e$8 = quotable._0;
                  return {
                          TAG: /* Error */1,
                          _0: {
                            path: "." + ("product-quotable" + e$8.path),
                            message: e$8.message,
                            value: e$8.value
                          }
                        };
                }
                var e$9 = delivery._0;
                return {
                        TAG: /* Error */1,
                        _0: {
                          path: "." + ("product-delivery" + e$9.path),
                          message: e$9.message,
                          value: e$9.value
                        }
                      };
              }
              var e$10 = operationStatus._0;
              return {
                      TAG: /* Error */1,
                      _0: {
                        path: "." + ("product-operation-status" + e$10.path),
                        message: e$10.message,
                        value: e$10.value
                      }
                    };
            }
            var e$11 = displayCategories._0;
            return {
                    TAG: /* Error */1,
                    _0: {
                      path: "." + ("display-categories" + e$11.path),
                      message: e$11.message,
                      value: e$11.value
                    }
                  };
          }
          var e$12 = productCategory._0;
          return {
                  TAG: /* Error */1,
                  _0: {
                    path: "." + ("product-category" + e$12.path),
                    message: e$12.message,
                    value: e$12.value
                  }
                };
        }
        var e$13 = origin._0;
        return {
                TAG: /* Error */1,
                _0: {
                  path: "." + ("origin" + e$13.path),
                  message: e$13.message,
                  value: e$13.value
                }
              };
      }
      var e$14 = basePrice._0;
      return {
              TAG: /* Error */1,
              _0: {
                path: "." + ("base-price" + e$14.path),
                message: e$14.message,
                value: e$14.value
              }
            };
    }
    var e$15 = buyerProductName._0;
    return {
            TAG: /* Error */1,
            _0: {
              path: "." + ("buyer-product-name" + e$15.path),
              message: e$15.message,
              value: e$15.value
            }
          };
  }
  var e$16 = producerProductName._0;
  return {
          TAG: /* Error */1,
          _0: {
            path: "." + ("producer-product-name" + e$16.path),
            message: e$16.message,
            value: e$16.value
          }
        };
}

var Form_formName = {
  producerProductName: "producer-product-name",
  buyerProductName: "buyer-product-name",
  basePrice: "base-price",
  origin: "origin",
  productCategory: "product-category",
  displayCategories: "display-categories",
  operationStatus: "product-operation-status",
  delivery: "product-delivery",
  quotable: "product-quotable",
  notice: "notice",
  noticeDateTo: "notice-date-to",
  noticeDateFrom: "notice-date-from",
  thumbnail: "thumbnail",
  documentURL: "document-url",
  editor: "description-html",
  notationInformationType: "notation-information-type",
  salesType: "sales-type"
};

var Form = {
  formName: Form_formName,
  submit_encode: submit_encode,
  submit_decode: submit_decode
};

function Update_Normal_Product_Form_Admin$ReadOnlyProducer(props) {
  return React.createElement("div", {
              className: "flex flex-col gap-2"
            }, React.createElement("div", undefined, React.createElement("span", {
                      className: "font-bold"
                    }, "생산자(대표자명)"), React.createElement("span", {
                      className: "text-notice"
                    }, "*")), React.createElement("div", {
                  className: "relative max-w-md w-1/3 h-9"
                }, React.createElement("div", {
                      className: "absolute w-full"
                    }, React.createElement(Async, {
                          value: props.value,
                          cacheOptions: false,
                          defaultOptions: false,
                          loadOptions: (function (param) {
                              return Promise.resolve([/* NotSelected */0]);
                            }),
                          onChange: (function (param) {
                              
                            }),
                          placeholder: "생산자명으로 찾기",
                          noOptionsMessage: (function (param) {
                              return "검색 결과가 없습니다.";
                            }),
                          isClearable: true,
                          isDisabled: true,
                          styles: {
                            menu: (function (provide, param) {
                                return Object.assign(Object.assign({}, provide), {
                                            position: "inherit"
                                          });
                              }),
                            control: (function (provide, param) {
                                return Object.assign(Object.assign({}, provide), {
                                            minHeight: "unset",
                                            height: "2.25rem"
                                          });
                              })
                          }
                        }))));
}

var ReadOnlyProducer = {
  make: Update_Normal_Product_Form_Admin$ReadOnlyProducer
};

function Update_Normal_Product_Form_Admin$Category(props) {
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  return React.createElement("div", {
              className: "flex flex-col gap-2"
            }, React.createElement("div", undefined, React.createElement("span", {
                      className: " font-bold"
                    }, "표준카테고리"), React.createElement("span", {
                      className: "text-notice"
                    }, "*")), React.createElement(Select_Product_Categories.make, {
                  control: match.control,
                  name: props.name,
                  disabled: false
                }));
}

var Category = {
  make: Update_Normal_Product_Form_Admin$Category
};

function Update_Normal_Product_Form_Admin$DisplayCategoryInput(props) {
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  return React.createElement("div", {
              className: "flex flex-col gap-2"
            }, React.createElement("div", undefined, React.createElement("span", {
                      className: " font-bold"
                    }, "전시카테고리"), React.createElement("span", {
                      className: "text-notice"
                    }, "*")), React.createElement(Product_Detail_Display_Categories.make, {
                  control: match.control,
                  name: props.name,
                  disabled: props.disabled
                }), React.createElement("div", undefined));
}

var DisplayCategoryInput = {
  make: Update_Normal_Product_Form_Admin$DisplayCategoryInput
};

function Update_Normal_Product_Form_Admin$ProductNameInputs(props) {
  var disabled = props.disabled;
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var register = match.register;
  var errors = match.formState.errors;
  var producerProductNameInput = register(props.producerProductName, {
        required: true,
        maxLength: 100
      });
  var buyerProductNameInput = register(props.buyerProductName, {
        required: true,
        maxLength: 100
      });
  return React.createElement(React.Fragment, undefined, React.createElement("div", {
                  className: "flex flex-col gap-2"
                }, React.createElement("label", {
                      className: "block",
                      htmlFor: producerProductNameInput.name
                    }, React.createElement("span", {
                          className: "font-bold"
                        }, "생산자용 상품명"), React.createElement("span", {
                          className: "text-notice"
                        }, "*")), React.createElement("div", undefined, React.createElement("input", {
                          ref: producerProductNameInput.ref,
                          defaultValue: props.producerProductNameDefaultValue,
                          className: getTextInputStyle(disabled),
                          id: producerProductNameInput.name,
                          disabled: disabled,
                          name: producerProductNameInput.name,
                          placeholder: "생산자용 상품명 입력(최대 100자)",
                          onBlur: producerProductNameInput.onBlur,
                          onChange: producerProductNameInput.onChange
                        }), React.createElement(ErrorMessage.ErrorMessage, {
                          name: producerProductNameInput.name,
                          errors: errors,
                          render: (function (param) {
                              return React.createElement("span", {
                                          className: "flex"
                                        }, React.createElement(IconError.make, {
                                              width: "20",
                                              height: "20"
                                            }), React.createElement("span", {
                                              className: "text-sm text-notice ml-1"
                                            }, "생산자용 상품명을 입력해주세요.(최대100자)"));
                            })
                        }))), React.createElement("div", {
                  className: "flex flex-col gap-2"
                }, React.createElement("label", {
                      className: "block",
                      htmlFor: buyerProductNameInput.name
                    }, React.createElement("span", {
                          className: "font-bold"
                        }, "바이어용 상품명"), React.createElement("span", {
                          className: "text-notice"
                        }, "*")), React.createElement("input", {
                      ref: buyerProductNameInput.ref,
                      defaultValue: props.buyerProductNameDefaultValue,
                      className: getTextInputStyle(disabled),
                      id: buyerProductNameInput.name,
                      disabled: disabled,
                      name: buyerProductNameInput.name,
                      placeholder: "바이어용 상품명 입력, 상품매장에 노출됨(최대 100자)",
                      onBlur: buyerProductNameInput.onBlur,
                      onChange: buyerProductNameInput.onChange
                    }), React.createElement(ErrorMessage.ErrorMessage, {
                      name: buyerProductNameInput.name,
                      errors: errors,
                      render: (function (param) {
                          return React.createElement("span", {
                                      className: "flex"
                                    }, React.createElement(IconError.make, {
                                          width: "20",
                                          height: "20"
                                        }), React.createElement("span", {
                                          className: "text-sm text-notice ml-1"
                                        }, "바이어용 상품명을 입력해주세요.(최대100자)"));
                        })
                    })));
}

var ProductNameInputs = {
  make: Update_Normal_Product_Form_Admin$ProductNameInputs
};

function Update_Normal_Product_Form_Admin$ReadOnlyProductId(props) {
  return React.createElement("div", {
              className: "flex flex-col gap-2"
            }, React.createElement("div", undefined, React.createElement("span", {
                      className: "font-bold"
                    }, "상품번호")), React.createElement("div", {
                  className: "px-3 py-2 border border-border-default-L1 bg-disabled-L3 text-disabled-L1 rounded-lg h-9 max-w-md w-1/3"
                }, React.createElement("span", {
                      className: "text-enabled-L1"
                    }, props.productId)));
}

var ReadOnlyProductId = {
  make: Update_Normal_Product_Form_Admin$ReadOnlyProductId
};

function Update_Normal_Product_Form_Admin$DisplayPriceInput(props) {
  var disabled = props.disabled;
  var name = props.name;
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var localeStringToFloat = function (value) {
    return Belt_Option.flatMap(Belt_Option.map(Belt_Option.flatMap(Belt_Option.flatMap(Belt_Option.map(Caml_option.null_to_opt(/^[\d,]+/.exec(value)), (function (prim) {
                                  return prim;
                                })), Garter_Array.first), (function (prim) {
                          if (prim == null) {
                            return ;
                          } else {
                            return Caml_option.some(prim);
                          }
                        })), (function (__x) {
                      return __x.replace(/,/g, "");
                    })), Belt_Float.fromString);
  };
  return React.createElement("div", {
              className: "flex flex-col gap-2"
            }, React.createElement("label", {
                  className: "block",
                  htmlFor: name
                }, React.createElement("span", {
                      className: "font-bold"
                    }, "전시매장 노출 기준가격"), React.createElement("span", {
                      className: "text-notice"
                    }, "*")), React.createElement(ReactHookForm$1.Controller, {
                  name: name,
                  control: Caml_option.some(match.control),
                  render: (function (param) {
                      var match = param.field;
                      var onChange = match.onChange;
                      var func = Locale.Float.show;
                      return React.createElement("input", {
                                  ref: match.ref,
                                  className: getTextInputStyle(disabled),
                                  id: match.name,
                                  disabled: disabled,
                                  placeholder: "가격 입력(단위 원)",
                                  type: "text",
                                  value: Belt_Option.mapWithDefault(Js_json.decodeNumber(match.value), "", (function (eta) {
                                          return Curry._3(func, undefined, eta, 0);
                                        })),
                                  onChange: (function (e) {
                                      var value = e.currentTarget.value;
                                      var validValue = Belt_Option.getWithDefault(Belt_Option.map(localeStringToFloat(value), (function (prim) {
                                                  return prim;
                                                })), "");
                                      Curry._1(onChange, Curry._1(ReactHookForm.Controller.OnChangeArg.value, validValue));
                                    })
                                });
                    }),
                  defaultValue: Caml_option.some(props.defaultValue),
                  rules: Caml_option.some(ReactHookForm.Rules.make(true, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined))
                }), React.createElement(ErrorMessage.ErrorMessage, {
                  name: name,
                  errors: match.formState.errors,
                  render: (function (param) {
                      return React.createElement("span", {
                                  className: "flex"
                                }, React.createElement(IconError.make, {
                                      width: "20",
                                      height: "20"
                                    }), React.createElement("span", {
                                      className: "text-sm text-notice ml-1"
                                    }, "전시매장 노출 기준가격을 입력해주세요."));
                    })
                }));
}

var DisplayPriceInput = {
  make: Update_Normal_Product_Form_Admin$DisplayPriceInput
};

function Update_Normal_Product_Form_Admin$OperationStatusInput(props) {
  var disabled = props.disabled;
  var name = props.name;
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var setValue = match.setValue;
  var errors = match.formState.errors;
  var match$1 = React.useState(function () {
        return /* Hide */1;
      });
  var setShowProductOperationNoSale = match$1[1];
  return React.createElement(React.Fragment, undefined, React.createElement("div", {
                  className: "flex flex-col gap-2 max-w-md w-1/3"
                }, React.createElement("div", undefined, React.createElement("span", {
                          className: "font-bold"
                        }, "운영상태"), React.createElement("span", {
                          className: "text-notice"
                        }, "*")), React.createElement(ReactHookForm$1.Controller, {
                      name: name,
                      control: Caml_option.some(match.control),
                      render: (function (param) {
                          var match = param.field;
                          var onChange = match.onChange;
                          return React.createElement("div", undefined, React.createElement(Select_Product_Operation_Status.Base.make, {
                                          status: Belt_Result.mapWithDefault(Select_Product_Operation_Status.Base.status_decode(match.value), undefined, (function (status) {
                                                  return status;
                                                })),
                                          onChange: (function (param) {
                                              if (param !== 3) {
                                                return Curry._1(onChange, Curry._1(ReactHookForm.Controller.OnChangeArg.value, Select_Product_Operation_Status.Base.status_encode(param)));
                                              } else {
                                                return setShowProductOperationNoSale(function (param) {
                                                            return /* Show */0;
                                                          });
                                              }
                                            }),
                                          forwardRef: match.ref,
                                          disabled: disabled
                                        }), React.createElement(ErrorMessage.ErrorMessage, {
                                          name: name,
                                          errors: errors,
                                          render: (function (param) {
                                              return React.createElement("span", {
                                                          className: "flex"
                                                        }, React.createElement(IconError.make, {
                                                              width: "20",
                                                              height: "20"
                                                            }), React.createElement("span", {
                                                              className: "text-sm text-notice ml-1"
                                                            }, "운영상태를 선택해주세요."));
                                            })
                                        }));
                        }),
                      defaultValue: Belt_Option.map(props.defaultValue, Select_Product_Operation_Status.Base.status_encode),
                      rules: Caml_option.some(ReactHookForm.Rules.make(true, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined))
                    })), React.createElement(Dialog.make, {
                  isShow: match$1[0],
                  children: React.createElement("p", undefined, "영구판매중지 상태를 선택 후 저장하시면", React.createElement("br", undefined), "추후 해당 상품을 수정할 수 없습니다.", React.createElement("br", undefined), React.createElement("br", undefined), "영구판매중지 상태로 변경할까요?"),
                  onCancel: (function (param) {
                      setShowProductOperationNoSale(function (param) {
                            return /* Hide */1;
                          });
                    }),
                  onConfirm: (function (param) {
                      setValue(name, Select_Product_Operation_Status.Base.status_encode(/* RETIRE */3));
                      setShowProductOperationNoSale(function (param) {
                            return /* Hide */1;
                          });
                    }),
                  textOnCancel: "닫기",
                  textOnConfirm: "확인",
                  kindOfConfirm: /* Negative */1,
                  boxStyle: "rounded-2xl text-center"
                }));
}

var OperationStatusInput = {
  make: Update_Normal_Product_Form_Admin$OperationStatusInput
};

function Update_Normal_Product_Form_Admin$OriginInput(props) {
  var disabled = props.disabled;
  var name = props.name;
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var productOrigin = match.register(name, {
        required: true
      });
  var tmp = {
    ref: productOrigin.ref,
    className: getTextInputStyle(disabled),
    id: productOrigin.name,
    disabled: disabled,
    name: productOrigin.name,
    placeholder: "원산지 입력",
    onBlur: productOrigin.onBlur,
    onChange: productOrigin.onChange
  };
  if (props.defaultValue !== undefined) {
    tmp.defaultValue = Caml_option.valFromOption(props.defaultValue);
  }
  return React.createElement("div", {
              className: "flex flex-col gap-2 max-w-md w-1/3"
            }, React.createElement("label", {
                  className: "block",
                  htmlFor: productOrigin.name
                }, React.createElement("span", {
                      className: "font-bold"
                    }, "원산지"), React.createElement("span", {
                      className: "text-notice"
                    }, "*")), React.createElement("input", tmp), React.createElement(ErrorMessage.ErrorMessage, {
                  name: name,
                  errors: match.formState.errors,
                  render: (function (param) {
                      return React.createElement("span", {
                                  className: "flex"
                                }, React.createElement(IconError.make, {
                                      width: "20",
                                      height: "20"
                                    }), React.createElement("span", {
                                      className: "text-sm text-notice ml-1"
                                    }, "원산지를 입력해주세요."));
                    })
                }));
}

var OriginInput = {
  make: Update_Normal_Product_Form_Admin$OriginInput
};

function Update_Normal_Product_Form_Admin$NotationTypeInput(props) {
  var name = props.name;
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var errors = match.formState.errors;
  return React.createElement("div", {
              className: "flex flex-col gap-2 max-w-md w-1/3"
            }, React.createElement("div", undefined, React.createElement("span", {
                      className: "font-bold"
                    }, "필수 표기정보 유형"), React.createElement("span", {
                      className: "text-notice"
                    }, "*")), React.createElement(ReactHookForm$1.Controller, {
                  name: name,
                  control: Caml_option.some(match.control),
                  render: (function (param) {
                      var match = param.field;
                      var onChange = match.onChange;
                      return React.createElement("div", undefined, React.createElement(Select_Product_NotationType_Admin.Notation.make, {
                                      status: Belt_Result.mapWithDefault(Select_Product_NotationType_Admin.Notation.status_decode(match.value), undefined, (function (status) {
                                              return status;
                                            })),
                                      onChange: (function (param) {
                                          return Curry._1(onChange, Curry._1(ReactHookForm.Controller.OnChangeArg.value, Select_Product_NotationType_Admin.Notation.status_encode(param)));
                                        }),
                                      forwardRef: match.ref
                                    }), React.createElement(ErrorMessage.ErrorMessage, {
                                      name: name,
                                      errors: errors,
                                      render: (function (param) {
                                          return React.createElement("span", {
                                                      className: "flex"
                                                    }, React.createElement(IconError.make, {
                                                          width: "20",
                                                          height: "20"
                                                        }), React.createElement("span", {
                                                          className: "text-sm text-notice ml-1"
                                                        }, "필수 표기정보 유형을 선택해주세요."));
                                        })
                                    }));
                    }),
                  defaultValue: Belt_Option.map(props.defaultValue, Select_Product_NotationType_Admin.Notation.status_encode),
                  rules: Caml_option.some(ReactHookForm.Rules.make(true, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined))
                }));
}

var NotationTypeInput = {
  make: Update_Normal_Product_Form_Admin$NotationTypeInput
};

function Update_Normal_Product_Form_Admin$ReadOnlyIsVat(props) {
  return React.createElement("div", {
              className: "flex flex-col gap-2 max-w-md w-1/3"
            }, React.createElement("div", undefined, React.createElement("span", {
                      className: "font-bold"
                    }, "과세여부"), React.createElement("span", {
                      className: "text-notice"
                    }, "*")), React.createElement(Select_Tax_Status.make, {
                  status: props.status,
                  onChange: (function (param) {
                      
                    }),
                  disabled: true
                }));
}

var ReadOnlyIsVat = {
  make: Update_Normal_Product_Form_Admin$ReadOnlyIsVat
};

function Update_Normal_Product_Form_Admin$IsCourierAvailableInput(props) {
  var disabled = props.disabled;
  var name = props.name;
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var errors = match.formState.errors;
  return React.createElement("div", {
              className: "flex flex-col gap-2 max-w-md w-1/3"
            }, React.createElement("div", undefined, React.createElement("span", {
                      className: "font-bold"
                    }, "택배가능여부"), React.createElement("span", {
                      className: "text-notice"
                    }, "*")), React.createElement(ReactHookForm$1.Controller, {
                  name: name,
                  control: Caml_option.some(match.control),
                  render: (function (param) {
                      var match = param.field;
                      var onChange = match.onChange;
                      return React.createElement("div", undefined, React.createElement(Select_Delivery.make, {
                                      status: Belt_Result.mapWithDefault(Select_Delivery.status_decode(match.value), undefined, (function (status) {
                                              return status;
                                            })),
                                      onChange: (function (e) {
                                          Curry._1(onChange, Curry._1(ReactHookForm.Controller.OnChangeArg.$$event, e));
                                        }),
                                      forwardRef: match.ref,
                                      disabled: disabled
                                    }), React.createElement(ErrorMessage.ErrorMessage, {
                                      name: name,
                                      errors: errors,
                                      render: (function (param) {
                                          return React.createElement("span", {
                                                      className: "flex"
                                                    }, React.createElement(IconError.make, {
                                                          width: "20",
                                                          height: "20"
                                                        }), React.createElement("span", {
                                                          className: "text-sm text-notice ml-1"
                                                        }, "택배가능여부를 선택해주세요."));
                                        })
                                    }));
                    }),
                  defaultValue: Caml_option.some(Select_Delivery.status_encode(props.defaultValue)),
                  rules: Caml_option.some(ReactHookForm.Rules.make(true, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined))
                }));
}

var IsCourierAvailableInput = {
  make: Update_Normal_Product_Form_Admin$IsCourierAvailableInput
};

function Update_Normal_Product_Form_Admin$QuotableCheckbox(props) {
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var quotable = match.register(props.name, undefined);
  return React.createElement("div", {
              className: "flex flex-col gap-2 max-w-md w-1/3"
            }, React.createElement("div", {
                  className: "block"
                }, React.createElement("span", {
                      className: "font-bold"
                    }, "견적 문의 버튼")), React.createElement("div", {
                  className: "flex gap-2 items-center"
                }, React.createElement(Checkbox.Uncontrolled.make, {
                      id: quotable.name,
                      name: quotable.name,
                      defaultChecked: props.defaultValue,
                      onBlur: quotable.onBlur,
                      onChange: quotable.onChange,
                      disabled: props.disabled,
                      inputRef: Caml_option.some(quotable.ref)
                    }), React.createElement("label", {
                      className: "cursor-pointer",
                      htmlFor: quotable.name
                    }, "견적 문의(가격 문의하기) 버튼 노출하기")));
}

var QuotableCheckbox = {
  make: Update_Normal_Product_Form_Admin$QuotableCheckbox
};

function Update_Normal_Product_Form_Admin$QuotationTypeInput(props) {
  var name = props.name;
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var errors = match.formState.errors;
  var quotableCheckboxValue = ReactHookForm$1.useWatch({
        name: props.quotableCheckboxName,
        defaultValue: props.defaultQuotable
      });
  var disabled = quotableCheckboxValue !== undefined && quotableCheckboxValue ? false : true;
  var t = Belt_Option.map(props.defaultValue, Select_Product_QuotationType_Admin.QuotationType.t_encode);
  return React.createElement("div", {
              className: "flex flex-col gap-2 max-w-md w-1/3"
            }, React.createElement("div", undefined, React.createElement("span", {
                      className: disabled ? "font-bold text-gray-400" : "font-bold"
                    }, "견적 유형"), React.createElement("span", {
                      className: disabled ? "text-gray-400" : "text-notice"
                    }, "*")), React.createElement(ReactHookForm$1.Controller, {
                  name: name,
                  control: Caml_option.some(match.control),
                  render: (function (param) {
                      var match = param.field;
                      var onChange = match.onChange;
                      return React.createElement("div", undefined, React.createElement(Select_Product_QuotationType_Admin.make, {
                                      status: Belt_Result.mapWithDefault(Select_Product_QuotationType_Admin.QuotationType.t_decode(match.value), undefined, (function (status) {
                                              return status;
                                            })),
                                      onChange: (function (s) {
                                          Curry._1(onChange, Curry._1(ReactHookForm.Controller.OnChangeArg.value, Select_Product_QuotationType_Admin.QuotationType.t_encode(s)));
                                        }),
                                      forwardRef: match.ref,
                                      disabled: disabled
                                    }), React.createElement(ErrorMessage.ErrorMessage, {
                                      name: name,
                                      errors: errors,
                                      render: (function (param) {
                                          return React.createElement("span", {
                                                      className: "flex"
                                                    }, React.createElement(IconError.make, {
                                                          width: "20",
                                                          height: "20"
                                                        }), React.createElement("span", {
                                                          className: "text-sm text-notice ml-1"
                                                        }, "견적 유형을 선택해주세요."));
                                        })
                                    }));
                    }),
                  defaultValue: Caml_option.some(t !== undefined ? Caml_option.valFromOption(t) : null),
                  rules: Caml_option.some(ReactHookForm.Rules.make(!disabled, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined))
                }));
}

var QuotationTypeInput = {
  make: Update_Normal_Product_Form_Admin$QuotationTypeInput
};

function Update_Normal_Product_Form_Admin$NoticeAndDateInput$DateInput(props) {
  var disabled = props.disabled;
  var minDate = props.minDate;
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var strToJson = function (dateStr) {
    return Format(new Date(dateStr), "yyyy-MM-dd");
  };
  var jsonToStr = function (jsonStr) {
    return Belt_Option.map(Belt_Option.keep(Js_json.decodeString(jsonStr), (function (str) {
                      return str !== "";
                    })), (function (prim) {
                  return new Date(prim);
                }));
  };
  return React.createElement(ReactHookForm$1.Controller, {
              name: props.name,
              control: Caml_option.some(match.control),
              render: (function (param) {
                  var match = param.field;
                  var onChange = match.onChange;
                  return React.createElement(DatePicker.make, {
                              id: match.name,
                              onChange: (function (e) {
                                  Curry._1(onChange, Curry._1(ReactHookForm.Controller.OnChangeArg.value, e.detail.value));
                                }),
                              date: jsonToStr(match.value),
                              minDate: minDate,
                              firstDayOfWeek: 0,
                              disabled: disabled
                            });
                }),
              defaultValue: Caml_option.some(Belt_Option.mapWithDefault(props.defaultValue, "", strToJson))
            });
}

var DateInput = {
  make: Update_Normal_Product_Form_Admin$NoticeAndDateInput$DateInput
};

function Update_Normal_Product_Form_Admin$NoticeAndDateInput(props) {
  var disabled = props.disabled;
  var noticeFromName = props.noticeFromName;
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var noticeDateFrom = ReactHookForm$1.useWatch({
        name: noticeFromName
      });
  var notice = match.register(props.noticeName, {
        maxLength: 1000
      });
  var tmp = {
    ref: notice.ref,
    className: "px-3 py-2 border border-border-default-L1 rounded-lg h-24 focus:outline-none min-w-1/2 max-w-2xl",
    id: notice.name,
    disabled: disabled,
    name: notice.name,
    placeholder: "공지사항 또는 메모 입력(최대 1000자)",
    onBlur: notice.onBlur,
    onChange: notice.onChange
  };
  if (props.defaultNotice !== undefined) {
    tmp.defaultValue = Caml_option.valFromOption(props.defaultNotice);
  }
  return React.createElement(React.Fragment, undefined, React.createElement("div", {
                  className: "flex flex-col gap-2"
                }, React.createElement("label", {
                      htmlFor: notice.name
                    }, React.createElement("span", {
                          className: "font-bold"
                        }, "공지사항")), React.createElement("textarea", tmp), React.createElement(ErrorMessage.ErrorMessage, {
                      name: notice.name,
                      errors: match.formState.errors,
                      render: (function (param) {
                          return React.createElement("span", {
                                      className: "flex"
                                    }, React.createElement(IconError.make, {
                                          width: "20",
                                          height: "20"
                                        }), React.createElement("span", {
                                          className: "text-sm text-notice ml-1"
                                        }, "공지사항은 최대 1000자까지 입력 가능합니다."));
                        })
                    })), React.createElement("div", {
                  className: "flex flex-col gap-2"
                }, React.createElement("span", {
                      className: "font-bold"
                    }, "공지사항 적용기간"), React.createElement("div", {
                      className: "flex gap-1"
                    }, React.createElement(Update_Normal_Product_Form_Admin$NoticeAndDateInput$DateInput, {
                          name: noticeFromName,
                          minDate: "2021-01-01",
                          defaultValue: props.defaultNoticeFrom,
                          disabled: disabled
                        }), React.createElement("span", {
                          className: "flex items-center"
                        }, "~"), React.createElement(Update_Normal_Product_Form_Admin$NoticeAndDateInput$DateInput, {
                          name: props.noticeToName,
                          minDate: Belt_Option.getWithDefault(noticeDateFrom, ""),
                          defaultValue: props.defaultNoticeTo,
                          disabled: disabled
                        }))));
}

var NoticeAndDateInput = {
  DateInput: DateInput,
  make: Update_Normal_Product_Form_Admin$NoticeAndDateInput
};

function Update_Normal_Product_Form_Admin$ThumbnailUploadInput(props) {
  var disabled = props.disabled;
  var name = props.name;
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  return React.createElement("div", {
              className: "flex flex-col gap-2"
            }, React.createElement("div", undefined, React.createElement("span", {
                      className: "font-bold"
                    }, "대표이미지(썸네일)"), React.createElement("span", {
                      className: "text-red-500"
                    }, "*"), React.createElement("span", {
                      className: "text-text-L2 ml-2"
                    }, "*이미지 파일 형식 등록 가능")), React.createElement("div", undefined, React.createElement(ReactHookForm$1.Controller, {
                      name: name,
                      control: Caml_option.some(match.control),
                      render: (function (param) {
                          var match = param.field;
                          var onChange = match.onChange;
                          return React.createElement(Upload_Thumbnail_Admin.make, {
                                      name: match.name,
                                      updateFn: (function (imageUrls) {
                                          Curry._1(onChange, Curry._1(ReactHookForm.Controller.OnChangeArg.value, Upload_Thumbnail_Admin.Form.image_encode(imageUrls)));
                                        }),
                                      value: Belt_Result.getWithDefault(Upload_Thumbnail_Admin.Form.image_decode(match.value), Upload_Thumbnail_Admin.Form.resetImage),
                                      disabled: disabled
                                    });
                        }),
                      defaultValue: Caml_option.some(Upload_Thumbnail_Admin.Form.image_encode(props.defaultValue)),
                      rules: Caml_option.some(ReactHookForm.Rules.make(true, undefined, undefined, undefined, undefined, undefined, Caml_option.some(Js_dict.fromArray([[
                                          "required",
                                          ReactHookForm.Validation.sync(function (value) {
                                                return Belt_Result.mapWithDefault(Upload_Thumbnail_Admin.Form.image_decode(value), false, (function (image) {
                                                              return image.original !== "";
                                                            }));
                                              })
                                        ]])), undefined, undefined, undefined))
                    }), React.createElement(ErrorMessage.ErrorMessage, {
                      name: name,
                      errors: match.formState.errors,
                      render: (function (param) {
                          return React.createElement("span", {
                                      className: "flex"
                                    }, React.createElement(IconError.make, {
                                          width: "20",
                                          height: "20"
                                        }), React.createElement("span", {
                                          className: "text-sm text-notice ml-1"
                                        }, "대표이미지(썸네일)을 선택해주세요."));
                        })
                    })));
}

var ThumbnailUploadInput = {
  make: Update_Normal_Product_Form_Admin$ThumbnailUploadInput
};

function Update_Normal_Product_Form_Admin$SalesDocumentURLInput(props) {
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var documentURL = match.register(props.name, undefined);
  var tmp = {
    ref: documentURL.ref,
    className: "py-2 px-3 h-9 border-border-default-L1 border rounded-lg focus:outline-none min-w-1/2 max-w-2xl",
    id: documentURL.name,
    disabled: props.disabled,
    name: documentURL.name,
    onBlur: documentURL.onBlur,
    onChange: documentURL.onChange
  };
  if (props.defaultValue !== undefined) {
    tmp.defaultValue = Caml_option.valFromOption(props.defaultValue);
  }
  return React.createElement("div", {
              className: "flex flex-col gap-2"
            }, React.createElement("label", {
                  className: "block font-bold"
                }, "판매자료 URL"), React.createElement("input", tmp));
}

var SalesDocumentURLInput = {
  make: Update_Normal_Product_Form_Admin$SalesDocumentURLInput
};

function Update_Normal_Product_Form_Admin$EditorInput(props) {
  var name = props.name;
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  return React.createElement("div", {
              className: "flex flex-col gap-2"
            }, React.createElement("div", {
                  className: "flex gap-2"
                }, React.createElement("div", undefined, React.createElement("span", {
                          className: "font-bold"
                        }, "상품설명"), React.createElement("span", {
                          className: "text-red-500"
                        }, "*")), React.createElement(ErrorMessage.ErrorMessage, {
                      name: name,
                      errors: match.formState.errors,
                      render: (function (param) {
                          return React.createElement("span", {
                                      className: "flex"
                                    }, React.createElement(IconError.make, {
                                          width: "20",
                                          height: "20"
                                        }), React.createElement("span", {
                                          className: "text-sm text-notice ml-1"
                                        }, "상품설명을 추가해주세요."));
                        })
                    })), React.createElement("div", undefined, React.createElement(Product_Detail_Editor.make, {
                      control: match.control,
                      name: name,
                      defaultValue: props.defaultValue,
                      disabled: props.disabled
                    })));
}

var EditorInput = {
  make: Update_Normal_Product_Form_Admin$EditorInput
};

function deliveryDecode(s) {
  if (s) {
    return /* AVAILABLE */0;
  } else {
    return /* UNAVAILABLE */1;
  }
}

function isVatDecode(s) {
  if (s) {
    return /* TAX */0;
  } else {
    return /* FREE */1;
  }
}

function producerToReactSelected(p) {
  return /* Selected */{
          value: p.id,
          label: Belt_Option.mapWithDefault(p.bossName, p.name, (function (bn) {
                  return "" + p.name + "(" + bn + ")";
                }))
        };
}

function toDisplayCategory(query) {
  var match = Belt_Option.map(Garter_Array.first(query), (function (param) {
          return param.type_;
        }));
  return {
          c5: Belt_Option.mapWithDefault(Belt_Array.get(query, 4), /* NotSelected */0, (function (d) {
                  return /* Selected */{
                          value: d.id,
                          label: d.name
                        };
                })),
          c4: Belt_Option.mapWithDefault(Belt_Array.get(query, 3), /* NotSelected */0, (function (d) {
                  return /* Selected */{
                          value: d.id,
                          label: d.name
                        };
                })),
          c3: Belt_Option.mapWithDefault(Belt_Array.get(query, 2), /* NotSelected */0, (function (d) {
                  return /* Selected */{
                          value: d.id,
                          label: d.name
                        };
                })),
          c2: Belt_Option.mapWithDefault(Belt_Array.get(query, 1), /* NotSelected */0, (function (d) {
                  return /* Selected */{
                          value: d.id,
                          label: d.name
                        };
                })),
          c1: Belt_Option.mapWithDefault(Belt_Array.get(query, 0), /* NotSelected */0, (function (d) {
                  return /* Selected */{
                          value: d.id,
                          label: d.name
                        };
                })),
          categoryType: match !== undefined ? (
              match === "NORMAL" ? /* Selected */({
                    value: "normal",
                    label: "일반"
                  }) : (
                  match === "SHOWCASE" ? /* Selected */({
                        value: "showcase",
                        label: "기획전"
                      }) : /* NotSelected */0
                )
            ) : /* NotSelected */0
        };
}

function toProductCategory(query) {
  return {
          c1: Belt_Option.mapWithDefault(Belt_Array.get(query, 0), /* NotSelected */0, (function (d) {
                  return /* Selected */{
                          value: d.id,
                          label: d.name
                        };
                })),
          c2: Belt_Option.mapWithDefault(Belt_Array.get(query, 1), /* NotSelected */0, (function (d) {
                  return /* Selected */{
                          value: d.id,
                          label: d.name
                        };
                })),
          c3: Belt_Option.mapWithDefault(Belt_Array.get(query, 2), /* NotSelected */0, (function (d) {
                  return /* Selected */{
                          value: d.id,
                          label: d.name
                        };
                })),
          c4: Belt_Option.mapWithDefault(Belt_Array.get(query, 3), /* NotSelected */0, (function (d) {
                  return /* Selected */{
                          value: d.id,
                          label: d.name
                        };
                })),
          c5: Belt_Option.mapWithDefault(Belt_Array.get(query, 4), /* NotSelected */0, (function (d) {
                  return /* Selected */{
                          value: d.id,
                          label: d.name
                        };
                }))
        };
}

function toImage(image) {
  return {
          original: image.original,
          thumb1000x1000: image.thumb1000x1000,
          thumb100x100: image.thumb100x100,
          thumb1920x1920: image.thumb1920x1920,
          thumb400x400: image.thumb400x400,
          thumb800x800: image.thumb800x800,
          thumb800xall: Belt_Option.getWithDefault(image.thumb800xall, image.thumb1920x1920)
        };
}

function encodeStatus(status) {
  switch (status) {
    case /* SALE */0 :
        return "SALE";
    case /* SOLDOUT */1 :
        return "SOLDOUT";
    case /* NOSALE */2 :
        return "NOSALE";
    case /* RETIRE */3 :
        return "RETIRE";
    case /* HIDDEN_SALE */4 :
        return "HIDDEN_SALE";
    
  }
}

function decodeStatus(s) {
  if (s === "NOSALE") {
    return /* NOSALE */2;
  } else if (s === "SOLDOUT") {
    return /* SOLDOUT */1;
  } else if (s === "HIDDEN_SALE") {
    return /* HIDDEN_SALE */4;
  } else if (s === "SALE") {
    return /* SALE */0;
  } else if (s === "RETIRE") {
    return /* RETIRE */3;
  } else {
    return ;
  }
}

function decodeNotationInformationType(v) {
  if (v === "WHOLE_FOOD") {
    return /* WHOLE_FOOD */1;
  } else if (v === "PROCESSED_FOOD") {
    return /* PROCESSED_FOOD */0;
  } else {
    return ;
  }
}

function decodeSalesType(s) {
  if (s === "RFQ_LIVESTOCK") {
    return /* RFQ_LIVESTOCK */1;
  } else if (s === "TRADEMATCH_AQUATIC") {
    return /* TRADEMATCH_AQUATIC */0;
  } else {
    return ;
  }
}

function makeNormalProductVariables(productId, form) {
  var match = form.notationInformationType;
  var tmp;
  if (form.quotable) {
    var match$1 = form.salesType;
    tmp = match$1 !== undefined ? (
        match$1 ? "RFQ_LIVESTOCK" : "TRADEMATCH_AQUATIC"
      ) : undefined;
  } else {
    tmp = undefined;
  }
  var tmp$1 = {
    categoryId: ProductForm.makeCategoryId(form.productCategory.c5),
    description: form.editor,
    displayCategoryIds: ProductForm.makeDisplayCategoryIds(form.displayCategories),
    displayName: form.buyerProductName,
    id: productId,
    image: {
      original: form.thumbnail.original,
      thumb100x100: form.thumbnail.thumb100x100,
      thumb400x400: form.thumbnail.thumb400x400,
      thumb800x800: form.thumbnail.thumb800x800,
      thumb800xall: form.thumbnail.thumb800xall,
      thumb1000x1000: form.thumbnail.thumb1000x1000,
      thumb1920x1920: form.thumbnail.thumb1920x1920
    },
    isCourierAvailable: Select_Delivery.toBool(form.delivery),
    name: form.producerProductName,
    notationInformationType: match ? "WHOLE_FOOD" : "PROCESSED_FOOD",
    origin: form.origin,
    price: form.basePrice,
    status: encodeStatus(form.operationStatus),
    type_: form.quotable ? "QUOTABLE" : "NORMAL"
  };
  var tmp$2 = Belt_Option.keep(form.notice, (function (str) {
          return str !== "";
        }));
  if (tmp$2 !== undefined) {
    tmp$1.notice = tmp$2;
  }
  var tmp$3 = ProductForm.makeNoticeDate(form.noticeEndAt, (function (prim) {
          return EndOfDay(prim);
        }));
  if (tmp$3 !== undefined) {
    tmp$1.noticeEndAt = tmp$3;
  }
  var tmp$4 = ProductForm.makeNoticeDate(form.noticeStartAt, (function (prim) {
          return StartOfDay(prim);
        }));
  if (tmp$4 !== undefined) {
    tmp$1.noticeStartAt = tmp$4;
  }
  var tmp$5 = Belt_Option.keep(form.documentURL, (function (str) {
          return str !== "";
        }));
  if (tmp$5 !== undefined) {
    tmp$1.salesDocument = tmp$5;
  }
  if (tmp !== undefined) {
    tmp$1.salesType = Caml_option.valFromOption(tmp);
  }
  return tmp$1;
}

function Update_Normal_Product_Form_Admin(props) {
  var isQuotable = props.isQuotable;
  var router = Router.useRouter();
  var product = use(props.query);
  var match = use$1(undefined);
  var isNormalMutating = match[1];
  var normalMutate = match[0];
  var match$1 = ReactToastNotifications.useToasts();
  var addToast = match$1.addToast;
  var match$2 = React.useState(function () {
        return /* Hide */1;
      });
  var setShowUpdateSuccess = match$2[1];
  var match$3 = React.useState(function () {
        return [
                /* Hide */1,
                undefined
              ];
      });
  var setErrorStatus = match$3[1];
  var errorStatus = match$3[0];
  var match$4 = React.useState(function () {
        return /* Hide */1;
      });
  var setShowInitialize = match$4[1];
  var disabled = product.status === "RETIRE";
  var methods = ReactHookForm$1.useForm({
        mode: "onChange",
        defaultValues: Js_dict.fromArray([
              [
                Product_Detail_Basic_Admin.Form.formName.displayCategories,
                Belt_Array.map(Belt_Array.map(Belt_Array.map(product.displayCategories, (function (d) {
                                return d.fullyQualifiedName;
                              })), toDisplayCategory), Select_Display_Categories.Form.submit_encode)
              ],
              [
                Product_Detail_Basic_Admin.Form.formName.productCategory,
                Select_Product_Category.Form.submit_encode(toProductCategory(product.category.fullyQualifiedName))
              ]
            ])
      }, undefined);
  var quotable = "product-quotable";
  var onSubmit = function (data, param) {
    var data$1 = submit_decode(data);
    if (data$1.TAG === /* Ok */0) {
      Curry.app(normalMutate, [
            (function (error) {
                addToast(React.createElement("div", {
                          className: "flex items-center"
                        }, React.createElement("span", {
                              className: "w-6 h-6 mr-2"
                            }, React.createElement(IconError.make, {
                                  width: "24",
                                  height: "24"
                                })), React.createElement("div", {
                              className: "w-full truncate"
                            }, "" + error.message + "")), {
                      appearance: "error"
                    });
              }),
            (function (param, param$1) {
                var updateProduct = param.updateProduct;
                if (typeof updateProduct === "object") {
                  var variant = updateProduct.NAME;
                  if (variant === "UpdateProductResult") {
                    return setShowUpdateSuccess(function (param) {
                                return /* Show */0;
                              });
                  }
                  if (variant === "Error") {
                    var message = updateProduct.VAL.message;
                    return setErrorStatus(function (param) {
                                return [
                                        /* Show */0,
                                        message
                                      ];
                              });
                  }
                  
                }
                setErrorStatus(function (param) {
                      return [
                              /* Show */0,
                              undefined
                            ];
                    });
              }),
            undefined,
            undefined,
            undefined,
            undefined,
            makeNormalProductVariables(product.id, data$1._0),
            undefined,
            undefined
          ]);
      return ;
    }
    console.log(data$1._0);
    addToast(React.createElement("div", {
              className: "flex items-center"
            }, React.createElement(IconError.make, {
                  width: "24",
                  height: "24",
                  className: "mr-2"
                }), "오류가 발생하였습니다. 수정내용을 확인하세요."), {
          appearance: "error"
        });
  };
  var handleReset = function (param) {
    return ReactEvents.interceptingHandler((function (param) {
                  setShowInitialize(function (param) {
                        return /* Show */0;
                      });
                }), param);
  };
  var producer$p = product.producer;
  var s = Belt_Option.getWithDefault(product.isVat, false);
  var s$1 = Belt_Option.getWithDefault(product.isCourierAvailable, false);
  var match$5 = product.status;
  var errorMessage = errorStatus[1];
  return React.createElement(ReactHookForm.Provider.make, {
              children: null,
              methods: methods
            }, React.createElement("form", {
                  onSubmit: methods.handleSubmit(onSubmit)
                }, React.createElement("section", {
                      className: "p-7 mx-4 bg-white rounded-b-md"
                    }, React.createElement("h2", {
                          className: "text-text-L1 text-lg font-bold"
                        }, "기본정보"), React.createElement("div", {
                          className: "divide-y text-sm"
                        }, React.createElement("div", {
                              className: "flex flex-col space-y-6 py-6"
                            }, producer$p !== undefined ? React.createElement(Update_Normal_Product_Form_Admin$ReadOnlyProducer, {
                                    value: producerToReactSelected(producer$p)
                                  }) : null, React.createElement(Update_Normal_Product_Form_Admin$Category, {
                                  name: "product-category"
                                }), React.createElement(Update_Normal_Product_Form_Admin$DisplayCategoryInput, {
                                  name: "display-categories",
                                  disabled: disabled
                                })), React.createElement("div", {
                              className: "flex flex-col space-y-6 py-6"
                            }, React.createElement(Update_Normal_Product_Form_Admin$ProductNameInputs, {
                                  producerProductName: "producer-product-name",
                                  producerProductNameDefaultValue: product.name,
                                  buyerProductName: "buyer-product-name",
                                  buyerProductNameDefaultValue: product.displayName,
                                  disabled: disabled
                                }), React.createElement(Update_Normal_Product_Form_Admin$ReadOnlyProductId, {
                                  productId: String(product.productId)
                                }), React.createElement(Update_Normal_Product_Form_Admin$DisplayPriceInput, {
                                  name: "base-price",
                                  defaultValue: Belt_Option.getWithDefault(product.price, -1),
                                  disabled: disabled
                                })), React.createElement("div", {
                              className: "py-6 flex flex-col space-y-6"
                            }, React.createElement("div", {
                                  className: "flex gap-2"
                                }, React.createElement(Update_Normal_Product_Form_Admin$OperationStatusInput, {
                                      name: "product-operation-status",
                                      defaultValue: decodeStatus(product.status),
                                      disabled: disabled
                                    }), React.createElement(Update_Normal_Product_Form_Admin$OriginInput, {
                                      name: "origin",
                                      defaultValue: product.origin,
                                      disabled: disabled
                                    }), React.createElement(Update_Normal_Product_Form_Admin$NotationTypeInput, {
                                      name: "notation-information-type",
                                      defaultValue: Belt_Option.flatMap(product.notationInformationType, decodeNotationInformationType)
                                    })), React.createElement("div", {
                                  className: "flex gap-2 text-sm"
                                }, React.createElement(Update_Normal_Product_Form_Admin$ReadOnlyIsVat, {
                                      status: s ? /* TAX */0 : /* FREE */1
                                    }), React.createElement(Update_Normal_Product_Form_Admin$IsCourierAvailableInput, {
                                      name: "product-delivery",
                                      defaultValue: s$1 ? /* AVAILABLE */0 : /* UNAVAILABLE */1,
                                      disabled: disabled
                                    }))), React.createElement("div", {
                              className: "py-6 flex space-y-6"
                            }, React.createElement(Update_Normal_Product_Form_Admin$QuotableCheckbox, {
                                  name: quotable,
                                  defaultValue: isQuotable,
                                  disabled: disabled
                                }), React.createElement(Update_Normal_Product_Form_Admin$QuotationTypeInput, {
                                  name: "sales-type",
                                  defaultValue: Belt_Option.flatMap(product.salesType, decodeSalesType),
                                  quotableCheckboxName: quotable,
                                  defaultQuotable: isQuotable
                                })))), React.createElement("section", {
                      className: "p-7 mt-4 mx-4 mb-7 bg-white rounded shadow-gl"
                    }, React.createElement("h2", {
                          className: "text-text-L1 text-lg font-bold"
                        }, "상품상세설명"), React.createElement("div", {
                          className: "text-sm py-6 flex flex-col space-y-6"
                        }, React.createElement(Update_Normal_Product_Form_Admin$NoticeAndDateInput, {
                              noticeName: "notice",
                              defaultNotice: product.notice,
                              noticeFromName: "notice-date-from",
                              defaultNoticeFrom: product.noticeStartAt,
                              noticeToName: "notice-date-to",
                              defaultNoticeTo: product.noticeEndAt,
                              disabled: disabled
                            }), React.createElement(Update_Normal_Product_Form_Admin$ThumbnailUploadInput, {
                              name: "thumbnail",
                              defaultValue: toImage(product.image),
                              disabled: disabled
                            }), React.createElement(Update_Normal_Product_Form_Admin$SalesDocumentURLInput, {
                              name: "document-url",
                              defaultValue: product.salesDocument,
                              disabled: disabled
                            }), React.createElement(Update_Normal_Product_Form_Admin$EditorInput, {
                              name: "description-html",
                              defaultValue: product.description,
                              disabled: disabled
                            }))), React.createElement("div", {
                      className: "fixed bottom-0 h-16 max-w-gnb-panel bg-white flex items-center gap-2 justify-end pr-10 w-full z-50"
                    }, match$5 === "RETIRE" ? React.createElement("button", {
                            className: "px-3 py-2 bg-disabled-L2 text-white rounded-lg focus:outline-none",
                            disabled: true,
                            type: "submit"
                          }, "상품을 수정할 수 없습니다.") : React.createElement(React.Fragment, undefined, React.createElement("button", {
                                className: "px-3 py-2 bg-div-shape-L1 rounded-lg focus:outline-none",
                                disabled: isNormalMutating,
                                type: "reset",
                                onClick: handleReset
                              }, "수정내용 초기화"), React.createElement("button", {
                                className: "px-3 py-2 bg-green-gl text-white rounded-lg hover:bg-green-gl-dark focus:outline-none",
                                disabled: isNormalMutating,
                                type: "submit"
                              }, "상품 수정")))), React.createElement(Dialog.make, {
                  isShow: match$4[0],
                  children: React.createElement("p", undefined, "수정한 모든 내용을 초기화 하시겠어요?"),
                  onCancel: (function (param) {
                      setShowInitialize(function (param) {
                            return /* Hide */1;
                          });
                    }),
                  onConfirm: (function (param) {
                      router.reload(router.pathname);
                      setShowInitialize(function (param) {
                            return /* Hide */1;
                          });
                    }),
                  textOnCancel: "닫기",
                  textOnConfirm: "초기화",
                  kindOfConfirm: /* Negative */1,
                  boxStyle: "text-center rounded-2xl"
                }), React.createElement(Dialog.make, {
                  isShow: match$2[0],
                  children: React.createElement("p", {
                        className: "text-gray-500 text-center whitespace-pre-wrap"
                      }, "상품정보가 수정되었습니다."),
                  onCancel: (function (param) {
                      setShowUpdateSuccess(function (param) {
                            return /* Hide */1;
                          });
                      router.reload(router.pathname);
                    }),
                  textOnCancel: "확인",
                  boxStyle: "text-center rounded-2xl"
                }), React.createElement(Dialog.make, {
                  isShow: errorStatus[0],
                  children: React.createElement("div", {
                        className: "text-gray-500 text-center whitespace-pre-wrap"
                      }, "상품정보 수정에 실패하였습니다.", errorMessage !== undefined ? React.createElement("p", undefined, errorMessage) : null),
                  onCancel: (function (param) {
                      setErrorStatus(function (param) {
                            return [
                                    /* Hide */1,
                                    undefined
                                  ];
                          });
                    }),
                  textOnCancel: "확인",
                  boxStyle: "text-center rounded-2xl"
                }));
}

var make = Update_Normal_Product_Form_Admin;

export {
  Fragment ,
  Mutation ,
  getTextInputStyle ,
  Form ,
  ReadOnlyProducer ,
  Category ,
  DisplayCategoryInput ,
  ProductNameInputs ,
  ReadOnlyProductId ,
  DisplayPriceInput ,
  OperationStatusInput ,
  OriginInput ,
  NotationTypeInput ,
  ReadOnlyIsVat ,
  IsCourierAvailableInput ,
  QuotableCheckbox ,
  QuotationTypeInput ,
  NoticeAndDateInput ,
  ThumbnailUploadInput ,
  SalesDocumentURLInput ,
  EditorInput ,
  deliveryDecode ,
  isVatDecode ,
  producerToReactSelected ,
  toDisplayCategory ,
  toProductCategory ,
  toImage ,
  encodeStatus ,
  decodeStatus ,
  decodeNotationInformationType ,
  decodeSalesType ,
  makeNormalProductVariables ,
  make ,
}
/* react Not a pure module */
