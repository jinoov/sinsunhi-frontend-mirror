// Generated by ReScript, PLEASE EDIT WITH CARE

import * as React from "react";
import * as Belt_Array from "rescript/lib/es6/belt_Array.js";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";
import * as ReactEvents from "../utils/ReactEvents.mjs";
import * as ReactHookForm from "react-hook-form";
import * as Add_ProductOption_Admin from "./Add_ProductOption_Admin.mjs";

function Add_ProductOptions_List_Admin(Props) {
  var productDisplayName = Props.productDisplayName;
  var isCourierAvailable = Props.isCourierAvailable;
  var formName = Props.formName;
  var match = React.useState(function () {
        return false;
      });
  var setApplyAll = match[1];
  var applyAll = match[0];
  var match$1 = ReactHookForm.useFormContext({
        mode: "onChange"
      }, undefined);
  var setValue = match$1.setValue;
  var match$2 = ReactHookForm.useFieldArray({
        name: formName,
        control: match$1.control,
        shouldUnregister: true
      });
  var remove = match$2.remove;
  var prepend = match$2.prepend;
  var fields = match$2.fields;
  var isOnlyOneRemained = fields.length === 1;
  var handleOnClickAdd = function (param) {
    return ReactEvents.interceptingHandler((function (param) {
                  setApplyAll(function (param) {
                        return false;
                      });
                  prepend(formName, {}, undefined);
                }), param);
  };
  var setTogether = function (fieldName, value) {
    Belt_Array.forEachWithIndex(Belt_Array.sliceToEnd(fields, 1), (function (index, param) {
            setValue("" + formName + "." + String(index + 1 | 0) + "." + fieldName + "", value);
          }));
  };
  var watchFirstCM = ReactHookForm.useWatch({
        name: [
          "" + formName + ".0.cut-off-time",
          "" + formName + ".0.memo"
        ]
      });
  React.useEffect((function () {
          if (applyAll && watchFirstCM !== undefined && watchFirstCM.length === 2) {
            var cutOffTime = watchFirstCM[0];
            var memo = watchFirstCM[1];
            setTogether("cut-off-time", Belt_Option.mapWithDefault(cutOffTime, null, (function (prim) {
                        return prim;
                      })));
            setTogether("memo", Belt_Option.mapWithDefault(memo, null, (function (prim) {
                        return prim;
                      })));
          }
          
        }), [
        applyAll,
        watchFirstCM
      ]);
  return React.createElement(React.Fragment, undefined, React.createElement("div", {
                  className: "flex justify-between items-center"
                }, React.createElement("h2", {
                      className: "text-text-L1 text-lg font-bold"
                    }, "단품 정보", React.createElement("span", {
                          className: "text-sm text-green-gl ml-2 font-normal"
                        }, "단품 " + String(fields.length) + "개")), React.createElement("button", {
                      onClick: (function (param) {
                          return ReactEvents.interceptingHandler((function (param) {
                                        
                                      }), param);
                        })
                    }), React.createElement("button", {
                      className: "px-3 py-2 bg-div-shape-L1 rounded-lg focus:outline-none",
                      onClick: handleOnClickAdd
                    }, "단품 추가하기")), React.createElement("div", {
                  className: "flex flex-col mt-7 mb-3 gap-6"
                }, Belt_Array.mapWithIndex(fields, (function (index, field) {
                        return React.createElement(Add_ProductOption_Admin.make, {
                                    prefix: "" + formName + "." + String(index) + "",
                                    index: index,
                                    remove: remove,
                                    prepend: prepend,
                                    isOnlyOneRemained: isOnlyOneRemained,
                                    productDisplayName: productDisplayName,
                                    applyAll: applyAll,
                                    setApplyAll: setApplyAll,
                                    isCourierAvailable: isCourierAvailable,
                                    key: field.id
                                  });
                      }))));
}

var make = Add_ProductOptions_List_Admin;

export {
  make ,
}
/* react Not a pure module */
