// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Curry from "rescript/lib/es6/curry.js";
import * as React from "react";
import * as Js_json from "rescript/lib/es6/js_json.js";
import * as IconClose from "./svgs/IconClose.mjs";
import * as IconError from "./svgs/IconError.mjs";
import * as Belt_Array from "rescript/lib/es6/belt_Array.js";
import * as DatePicker from "./DatePicker.mjs";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";
import * as Caml_option from "rescript/lib/es6/caml_option.js";
import * as ReactEvents from "../utils/ReactEvents.mjs";
import * as Router from "next/router";
import * as ReactHookForm from "../bindings/ReactHookForm/ReactHookForm.mjs";
import Format from "date-fns/format";
import * as ReactHookForm$1 from "react-hook-form";
import AddDays from "date-fns/addDays";
import AddHours from "date-fns/addHours";
import * as SearchAddressEmbed from "./SearchAddressEmbed.mjs";
import * as Web_Order_Buyer_Form from "./Web_Order_Buyer_Form.mjs";
import * as ReactDialog from "@radix-ui/react-dialog";
import * as ErrorMessage from "@hookform/error-message";
import * as Web_Order_Util_Component from "./Web_Order_Util_Component.mjs";
import * as FreightDeliveryCost_Table_Buyer from "./FreightDeliveryCost_Table_Buyer.mjs";

function Web_Order_Inputs_Buyer$ReceiverNameInput(props) {
  var formNames = Web_Order_Buyer_Form.names(props.prefix);
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var match$1 = match.register(formNames.receiverName, {
        required: true,
        maxLength: 50
      });
  var name = match$1.name;
  return React.createElement("div", {
              className: "flex flex-col gap-2 xl:gap-0 xl:flex-row xl:items-baseline"
            }, React.createElement("label", {
                  className: "xl:w-1/4 block font-bold text-text-L1",
                  htmlFor: name
                }, "이름"), React.createElement("div", {
                  className: "w-full xl:w-3/4"
                }, React.createElement("input", {
                      ref: match$1.ref,
                      className: "w-full h-13 xl:h-9 px-3 border border-gray-300 rounded-lg",
                      id: name,
                      name: name,
                      placeholder: "배송 받으실 분의 이름을 입력해주세요",
                      onBlur: match$1.onBlur,
                      onChange: match$1.onChange
                    }), React.createElement(ErrorMessage.ErrorMessage, {
                      name: name,
                      errors: match.formState.errors,
                      render: (function (param) {
                          return React.createElement("span", {
                                      className: "flex mt-1"
                                    }, React.createElement(IconError.make, {
                                          width: "20",
                                          height: "20"
                                        }), React.createElement("span", {
                                          className: "text-sm text-notice ml-1"
                                        }, "배송 받으실 분의 이름을 입력해주세요"));
                        })
                    })));
}

var ReceiverNameInput = {
  make: Web_Order_Inputs_Buyer$ReceiverNameInput
};

function Web_Order_Inputs_Buyer$ReceiverPhoneInput(props) {
  var formNames = Web_Order_Buyer_Form.names(props.prefix);
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var errors = match.formState.errors;
  var newValue = function (e) {
    var str = e.currentTarget.value.slice(0, 14).replace(/[^0-9]/g, "");
    return (
              str.length === 12 ? str.replace(/([0-9]{4})([0-9]{4})([0-9]{4})/, "$1-$2-$3") : str.replace(/(^02.{0}|^01.{1}|[0-9]{3})([0-9]+)([0-9]{4})/, "$1-$2-$3")
            ).replace("--", "-");
  };
  return React.createElement("div", {
              className: "flex flex-col gap-2 xl:gap-0 xl:max-w-full xl:flex-row text-text-L1 xl:items-baseline"
            }, React.createElement("label", {
                  className: "xl:w-1/4 block font-bold",
                  htmlFor: formNames.receiverPhone
                }, "연락처"), React.createElement("div", {
                  className: "w-full xl:w-3/4"
                }, React.createElement(ReactHookForm$1.Controller, {
                      name: formNames.receiverPhone,
                      control: Caml_option.some(match.control),
                      render: (function (param) {
                          var match = param.field;
                          var onChange = match.onChange;
                          return React.createElement(React.Fragment, undefined, React.createElement("input", {
                                          ref: match.ref,
                                          className: "w-full h-13 xl:h-9 px-3 border border-gray-300 rounded-lg",
                                          placeholder: "배송 받으실 분의 연락처를 입력해주세요",
                                          value: Belt_Option.getWithDefault(Js_json.decodeString(match.value), ""),
                                          onChange: (function (param) {
                                              return Curry._1(onChange, Curry._1(ReactHookForm.Controller.OnChangeArg.value, newValue(param)));
                                            })
                                        }), React.createElement(ErrorMessage.ErrorMessage, {
                                          name: match.name,
                                          errors: errors,
                                          render: (function (param) {
                                              return React.createElement("span", {
                                                          className: "flex mt-1"
                                                        }, React.createElement(IconError.make, {
                                                              width: "20",
                                                              height: "20"
                                                            }), React.createElement("span", {
                                                              className: "text-sm text-notice ml-1"
                                                            }, "배송 받으실 분의 연락처를 입력해주세요"));
                                            })
                                        }));
                        }),
                      defaultValue: "",
                      rules: Caml_option.some(ReactHookForm.Rules.make(true, undefined, 10, undefined, undefined, undefined, undefined, undefined, undefined, undefined))
                    })));
}

var ReceiverPhoneInput = {
  make: Web_Order_Inputs_Buyer$ReceiverPhoneInput
};

function Web_Order_Inputs_Buyer$ReceiverAddressInput(props) {
  var deviceType = props.deviceType;
  var router = Router.useRouter();
  var match = React.useState(function () {
        return false;
      });
  var setShowSearchAddress = match[1];
  var isShowSearchAddress = match[0];
  var formNames = Web_Order_Buyer_Form.names(props.prefix);
  var match$1 = ReactHookForm$1.useFormContext({
        mode: "all"
      }, undefined);
  var register = match$1.register;
  var setValue = match$1.setValue;
  var errors = match$1.formState.errors;
  var zipcodeRegister = register(formNames.receiverZipCode, {
        required: true
      });
  var addressRegister = register(formNames.receiverAddress, undefined);
  var detailAdressRegister = register(formNames.receiverDetailAddress, {
        required: true,
        maxLength: 50
      });
  var handleOnClickSearchAddress = function (changeFn) {
    return function (param) {
      return ReactEvents.interceptingHandler((function (param) {
                    if (deviceType !== 1) {
                      if (!router.asPath.includes("#search-address-opened")) {
                        router.push("" + router.asPath + "#search-address-opened");
                      }
                      return setShowSearchAddress(function (param) {
                                  return true;
                                });
                    }
                    var option = {
                      oncomplete: (function (data) {
                          Curry._1(changeFn, Curry._1(ReactHookForm.Controller.OnChangeArg.value, data.zonecode));
                          setValue(formNames.receiverAddress, data.address);
                        })
                    };
                    var daumPostCode = new (daum.Postcode)(option);
                    var openOption = {
                      popupName: "우편번호 검색"
                    };
                    daumPostCode.open(openOption);
                  }), param);
    };
  };
  React.useEffect((function () {
          if (!router.asPath.includes("#search-address-opened") && isShowSearchAddress) {
            setShowSearchAddress(function (param) {
                  return false;
                });
          }
          
        }), [router.asPath]);
  return React.createElement(React.Fragment, undefined, React.createElement("div", {
                  className: "flex flex-col gap-2 xl:flex-row xl:gap-0 xl:items-baseline"
                }, React.createElement("label", {
                      className: "block font-bold text-text-L1 xl:w-1/4"
                    }, "주소"), React.createElement("div", {
                      className: "flex flex-col gap-2 w-full xl:w-3/4"
                    }, React.createElement("div", {
                          className: "flex flex-col gap-1"
                        }, React.createElement(ReactHookForm$1.Controller, {
                              name: zipcodeRegister.name,
                              control: Caml_option.some(match$1.control),
                              render: (function (param) {
                                  var match = param.field;
                                  var onChange = match.onChange;
                                  var name = match.name;
                                  return React.createElement(React.Fragment, undefined, React.createElement("div", {
                                                  className: "flex gap-1"
                                                }, React.createElement("input", {
                                                      ref: match.ref,
                                                      className: "w-full xl:w-40 h-13 xl:h-9 px-3 border border-gray-300 rounded-lg bg-disabled-L3 text-disabled-L1",
                                                      id: name,
                                                      name: name,
                                                      placeholder: "우편번호",
                                                      readOnly: true,
                                                      value: Belt_Option.getWithDefault(Js_json.decodeString(match.value), ""),
                                                      onBlur: zipcodeRegister.onBlur
                                                    }), React.createElement("button", {
                                                      className: "px-3 min-w-max py-1.5 h-13 xl:h-9 text-white bg-blue-gray-700 rounded-lg",
                                                      type: "button",
                                                      onClick: handleOnClickSearchAddress(onChange)
                                                    }, "주소검색")), React.createElement(ErrorMessage.ErrorMessage, {
                                                  name: formNames.receiverZipCode,
                                                  errors: errors,
                                                  render: (function (param) {
                                                      return React.createElement("span", {
                                                                  className: "flex"
                                                                }, React.createElement(IconError.make, {
                                                                      width: "20",
                                                                      height: "20"
                                                                    }), React.createElement("span", {
                                                                      className: "text-sm text-notice ml-1"
                                                                    }, "'주소검색'을 통해 우편번호를 입력해주세요"));
                                                    })
                                                }), React.createElement(ReactDialog.Root, {
                                                  children: null,
                                                  _open: isShowSearchAddress
                                                }, React.createElement(ReactDialog.Overlay, {
                                                      className: "dialog-overlay"
                                                    }), React.createElement(ReactDialog.Content, {
                                                      children: null,
                                                      className: "dialog-content-plain top-0 bottom-0 left-0 right-0"
                                                    }, React.createElement("section", {
                                                          className: "h-14 w-full xl:h-auto xl:w-auto xl:mt-10"
                                                        }, React.createElement("div", {
                                                              className: "flex items-center justify-between px-5 w-full py-4 xl:h-14 xl:w-full xl:pb-10"
                                                            }, React.createElement("div", {
                                                                  className: "w-6 xl:hidden"
                                                                }), React.createElement("div", undefined, React.createElement("span", {
                                                                      className: "font-bold xl:text-2xl"
                                                                    }, "주소 검색")), React.createElement(ReactDialog.Close, {
                                                                  onClick: (function (param) {
                                                                      router.back();
                                                                    }),
                                                                  children: React.createElement(IconClose.make, {
                                                                        height: "24",
                                                                        width: "24",
                                                                        fill: "#262626"
                                                                      }),
                                                                  className: "focus:outline-none"
                                                                }))), React.createElement(SearchAddressEmbed.make, {
                                                          onComplete: (function (param) {
                                                              Curry._1(onChange, Curry._1(ReactHookForm.Controller.OnChangeArg.value, param.zonecode));
                                                              setValue(formNames.receiverAddress, param.address);
                                                              return setShowSearchAddress(function (param) {
                                                                          return false;
                                                                        });
                                                            }),
                                                          isShow: true
                                                        }))));
                                }),
                              defaultValue: "",
                              rules: Caml_option.some(ReactHookForm.Rules.make(true, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined, undefined))
                            })), React.createElement("input", {
                          ref: addressRegister.ref,
                          className: "w-full h-13 xl:h-9 px-3 border border-gray-300 rounded-lg bg-disabled-L3 text-disabled-L1",
                          id: addressRegister.name,
                          name: addressRegister.name,
                          placeholder: "우편번호 찾기를 통해 주소입력이 가능합니다.",
                          readOnly: true,
                          onBlur: addressRegister.onBlur,
                          onChange: addressRegister.onChange
                        }), React.createElement("input", {
                          ref: detailAdressRegister.ref,
                          className: "w-full h-13 xl:h-9 px-3 border border-gray-300 rounded-lg ",
                          id: detailAdressRegister.name,
                          name: detailAdressRegister.name,
                          placeholder: "상세주소를 입력해주세요.",
                          onBlur: detailAdressRegister.onBlur,
                          onChange: detailAdressRegister.onChange
                        }), React.createElement(ErrorMessage.ErrorMessage, {
                          name: detailAdressRegister.name,
                          errors: errors,
                          render: (function (param) {
                              return React.createElement("span", {
                                          className: "flex mt-1"
                                        }, React.createElement(IconError.make, {
                                              width: "20",
                                              height: "20"
                                            }), React.createElement("span", {
                                              className: "text-sm text-notice ml-1"
                                            }, "상세주소를 입력해주세요"));
                            })
                        }))));
}

var ReceiverAddressInput = {
  make: Web_Order_Inputs_Buyer$ReceiverAddressInput
};

function Web_Order_Inputs_Buyer$DeliveryMessageInput(props) {
  var selfMode = props.selfMode;
  var selfMode$1 = selfMode !== undefined ? selfMode : false;
  var formNames = Web_Order_Buyer_Form.names(props.prefix);
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var match$1 = match.register(formNames.deliveryMessage, {
        maxLength: 100
      });
  var name = match$1.name;
  return React.createElement("div", {
              className: "flex flex-col gap-2 xl:gap-0 xl:max-w-full xl:flex-row text-text-L1 xl:items-baseline"
            }, React.createElement("label", {
                  className: "xl:w-1/4 block font-bold",
                  htmlFor: name
                }, "" + (
                  selfMode$1 ? "수령시" : "배송"
                ) + " 요청사항"), React.createElement("div", {
                  className: "w-full xl:w-3/4"
                }, React.createElement("input", {
                      ref: match$1.ref,
                      className: "w-full h-13 xl:h-9 px-3 border border-gray-300 rounded-lg",
                      id: name,
                      name: name,
                      placeholder: "" + (
                        selfMode$1 ? "수령" : "배송"
                      ) + "시 요청사항을 입력해주세요 (최대 100자)",
                      onBlur: match$1.onBlur,
                      onChange: match$1.onChange
                    }), React.createElement(ErrorMessage.ErrorMessage, {
                      name: name,
                      errors: match.formState.errors,
                      render: (function (param) {
                          return React.createElement("span", {
                                      className: "flex mt-1"
                                    }, React.createElement(IconError.make, {
                                          width: "20",
                                          height: "20"
                                        }), React.createElement("span", {
                                          className: "text-sm text-notice ml-1"
                                        }, "최대 100자 까지 입력해주세요"));
                        })
                    })));
}

var DeliveryMessageInput = {
  make: Web_Order_Inputs_Buyer$DeliveryMessageInput
};

function Web_Order_Inputs_Buyer$DeliveryDesiredDateSelection(props) {
  var selfMode = props.selfMode;
  var selfMode$1 = selfMode !== undefined ? selfMode : false;
  var formNames = Web_Order_Buyer_Form.names(props.prefix);
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var t = AddHours(new Date(), 39);
  var match$1 = t.getDay();
  var minDate = match$1 !== 0 ? (
      match$1 !== 6 ? t : AddDays(t, 2)
    ) : AddDays(t, 1);
  return React.createElement("div", {
              className: "flex flex-col xl:flex-row gap-2 xl:gap-0 xl:w-full xl:items-baseline"
            }, React.createElement("label", {
                  className: "xl:w-1/4 block font-bold"
                }, "" + (
                  selfMode$1 ? "수령" : "배송"
                ) + " 희망일"), React.createElement("div", {
                  className: "flex flex-col gap-1 w-full xl:w-3/4"
                }, React.createElement("div", {
                      className: "flex gap-2"
                    }, React.createElement(ReactHookForm$1.Controller, {
                          name: formNames.deliveryDesiredDate,
                          control: Caml_option.some(match.control),
                          render: (function (param) {
                              var onChange = param.field.onChange;
                              return React.createElement(DatePicker.make, {
                                          id: "from",
                                          onChange: (function (param) {
                                              var newDate = param.detail.value;
                                              return Curry._1(onChange, Curry._1(ReactHookForm.Controller.OnChangeArg.value, newDate));
                                            }),
                                          date: Caml_option.some(minDate),
                                          minDate: Format(minDate, "yyyy-MM-dd"),
                                          firstDayOfWeek: 0,
                                          isDateDisabled: (function (d) {
                                              if (d.getDay() === 0) {
                                                return true;
                                              } else {
                                                return d.getDay() === 6;
                                              }
                                            })
                                        });
                            }),
                          defaultValue: Caml_option.some(Format(minDate, "yyy-MM-dd")),
                          shouldUnregister: true
                        }), selfMode$1 ? null : React.createElement(FreightDeliveryCost_Table_Buyer.make, {})), React.createElement("span", {
                      className: "text-sm text-text-L2"
                    }, "* 원하시는 날짜에 맞춰 물량 확보 및 " + (
                      selfMode$1 ? "수령" : "배송"
                    ) + "이 가능한지 확인 후 연락 드립니다.")));
}

var DeliveryDesiredDateSelection = {
  make: Web_Order_Inputs_Buyer$DeliveryDesiredDateSelection
};

function Web_Order_Inputs_Buyer$PaymentMethodSelection(props) {
  var deviceType = props.deviceType;
  var formNames = Web_Order_Buyer_Form.names(props.prefix);
  var match = ReactHookForm$1.useFormContext({
        mode: "onChange"
      }, undefined);
  var match$1 = match.register(formNames.paymentMethod, {
        required: true
      });
  var name = match$1.name;
  var ref = match$1.ref;
  var onBlur = match$1.onBlur;
  var onChange = match$1.onChange;
  var watchValue = ReactHookForm$1.useWatch({
        name: formNames.paymentMethod
      });
  return React.createElement("section", {
              className: "flex flex-col gap-5 bg-white text-enabled-L1"
            }, React.createElement("span", {
                  className: "text-lg xl:text-xl font-bold"
                }, "결제 수단 선택"), React.createElement("div", {
                  className: "flex gap-2"
                }, Belt_Array.map([
                      [
                        "card",
                        "카드결제"
                      ],
                      [
                        "transfer",
                        "계좌이체"
                      ]
                    ], (function (param) {
                        var n = param[1];
                        var value = param[0];
                        return React.createElement("label", {
                                    key: n,
                                    className: "focus:outline-none focus-within:bg-primary-light focus-within:outline-none focus-within:rounded-xl"
                                  }, React.createElement("input", {
                                        ref: ref,
                                        className: "sr-only",
                                        id: name,
                                        name: name,
                                        type: "radio",
                                        value: value,
                                        onBlur: onBlur,
                                        onChange: onChange
                                      }), React.createElement(Web_Order_Util_Component.RadioButton.make, {
                                        watchValue: watchValue,
                                        name: n,
                                        value: value,
                                        deviceType: deviceType
                                      }));
                      }))), React.createElement(ErrorMessage.ErrorMessage, {
                  name: name,
                  errors: match.formState.errors,
                  render: (function (param) {
                      return React.createElement("span", {
                                  className: "flex"
                                }, React.createElement(IconError.make, {
                                      width: "20",
                                      height: "20"
                                    }), React.createElement("span", {
                                      className: "text-sm text-notice ml-1"
                                    }, "결제 수단을 선택해주세요"));
                    })
                }));
}

var PaymentMethodSelection = {
  make: Web_Order_Inputs_Buyer$PaymentMethodSelection
};

var Form;

export {
  Form ,
  ReceiverNameInput ,
  ReceiverPhoneInput ,
  ReceiverAddressInput ,
  DeliveryMessageInput ,
  DeliveryDesiredDateSelection ,
  PaymentMethodSelection ,
}
/* react Not a pure module */
